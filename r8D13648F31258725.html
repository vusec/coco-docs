<!DOCTYPE html><html><head><meta charset="utf-8"></meta><meta content="width=device-width, initial-scale=1" name="viewport"></meta><title>class CrashRecoveryContext: LLVM 10.0.0 documentation</title><link href="styles.css" rel="stylesheet"></link><script src="highlight.min.js"></script><script>hljs.highlightAll();</script><link href="katex.min.css" rel="stylesheet"></link><script src="katex.min.js"></script><script src="auto-render.min.js"></script><script>
    document.addEventListener("DOMContentLoaded", function() {
      renderMathInElement(document.body, {
        delimiters: [
          {left: '$$', right: '$$', display: true},
          {left: '$', right: '$', display: false},
        ],
      });
    });
  </script><link href="apple-touch-icon.png" sizes="180x180" rel="apple-touch-icon"></link><link href="favicon-32x32.png" sizes="32x32" type="image/png" rel="icon"></link><link href="favicon-16x16.png" sizes="16x16" type="image/png" rel="icon"></link></head><body><div id="wrapper"><section class="section"><div class="container"><div class="columns"><aside class="column is-one-fifth"><ul class="menu-list"><p class="is-size-4">LLVM 10.0.0</p><p class="menu-label">Navigation</p><li><a href="index.html">Home</a></li><li><a href="search.html">Search</a></li><li><a href="https://github.com/llvm/llvm-project/">Repository</a></li><li><a href="https://hdoc.io">Made with hdoc</a></li><p class="menu-label">API Documentation</p><li><a href="functions.html">Functions</a></li><li><a href="records.html">Records</a></li><li><a href="enums.html">Enums</a></li><li><a href="namespaces.html">Namespaces</a></li></ul></aside><div class="column" style="overflow-x: auto"><nav class="breadcrumb has-arrow-separator" aria-label="breadcrumbs"><ul><li><a href="namespaces.html#00A4DA910CC17C2D"><span>namespace llvm</span></a></li><li class="is-active"><a aria-current="page8D13648F31258725"><span>class CrashRecoveryContext</span></a></li></ul></nav><main class="content"><h1>class CrashRecoveryContext</h1><h2>Declaration</h2><pre class="p-0"><code class="hdoc-record-code language-cpp">class CrashRecoveryContext { /* full declaration omitted */ };</code></pre><h2>Description</h2><p>Crash recovery helper object. This class implements support for running operations in a safe context so that crashes (memory errors, stack overflow, assertion violations) can be detected and control restored to the crashing thread. Crash detection is purely &quot;best effort&quot;, the exact set of failures which can be recovered from is platform dependent. Clients make use of this code by first calling CrashRecoveryContext::Enable(), and then executing unsafe operations via a CrashRecoveryContext object. For example: To assist recovery the class allows specifying set of actions that will be executed in any case, whether crash occurs or not. These actions may be used to reclaim resources in the case of crash.</p><p>Declared at: <a class="is-family-code" href="https://github.com/llvm/llvm-project/blob/release/10.x/llvm/include/llvm/Support/CrashRecoveryContext.h#L46">llvm/include/llvm/Support/CrashRecoveryContext.h:46</a></p><h2>Member Variables</h2><dl><dt class="is-family-code" id="var_RetCode">public  int <b>RetCode</b> = 0</dt><dd>In case of a crash, this is the crash identifier.</dd><dt class="is-family-code" id="var_DumpStackAndCleanupOnFailure">public  bool <b>DumpStackAndCleanupOnFailure</b> = false</dt><dd>Selects whether handling of failures should be done in the same way as for regular crashes. When this is active, a crash would print the callstack, clean-up any temporary files and create a coredump/minidump.</dd></dl><h2>Method Overview</h2><ul><li class="is-family-code">public  <a href="#1CC0425B62FBBCE5"><b>CrashRecoveryContext</b></a>()</li><li class="is-family-code">public static void  <a href="#EF6D836D4B1A60C7"><b>Disable</b></a>()</li><li class="is-family-code">public static void  <a href="#DBBCE96D528F0259"><b>Enable</b></a>()</li><li class="is-family-code">public static llvm::CrashRecoveryContext *  <a href="#55891A235FF0252C"><b>GetCurrent</b></a>()</li><li class="is-family-code">public void  <a href="#F2A921A5FD087C13"><b>HandleExit</b></a>(int RetCode)</li><li class="is-family-code">public bool  <a href="#B485719EAE246E14"><b>RunSafely</b></a>(function_ref&lt;void ()&gt; Fn)</li><li class="is-family-code">public bool  <a href="#AED8EA674104682C"><b>RunSafely</b></a>(void (*)(void *) Fn, void * UserData)</li><li class="is-family-code">public bool  <a href="#23268F157FDC356C"><b>RunSafelyOnThread</b></a>(function_ref&lt;void ()&gt;, unsigned int RequestedStackSize = 0)</li><li class="is-family-code">public bool  <a href="#0E71A811A04836BD"><b>RunSafelyOnThread</b></a>(void (*)(void *) Fn, void * UserData, unsigned int RequestedStackSize = 0)</li><li class="is-family-code">public static bool  <a href="#D50F9E32146E62A3"><b>isRecoveringFromCrash</b></a>()</li><li class="is-family-code">public void  <a href="#3B1D290790A1EC46"><b>registerCleanup</b></a>(llvm::CrashRecoveryContextCleanup * cleanup)</li><li class="is-family-code">public void  <a href="#87C48B5F40BB1A13"><b>unregisterCleanup</b></a>(llvm::CrashRecoveryContextCleanup * cleanup)</li><li class="is-family-code">public  <a href="#B4C0075EEA6E8F55"><b>~CrashRecoveryContext</b></a>()</li></ul><h2>Methods</h2><h3 id="1CC0425B62FBBCE5"><pre class="p-0 hdoc-pre-parent"><a class="hdoc-permalink-icon" href="#1CC0425B62FBBCE5">¶</a><code class="hdoc-function-code language-cpp">CrashRecoveryContext()</code></pre></h3><p>Declared at: <a class="is-family-code" href="https://github.com/llvm/llvm-project/blob/release/10.x/llvm/include/llvm/Support/CrashRecoveryContext.h#L51">llvm/include/llvm/Support/CrashRecoveryContext.h:51</a></p><h3 id="EF6D836D4B1A60C7"><pre class="p-0 hdoc-pre-parent"><a class="hdoc-permalink-icon" href="#EF6D836D4B1A60C7">¶</a><code class="hdoc-function-code language-cpp">static void Disable()</code></pre></h3><h4>Description</h4><p>Disable crash recovery.</p><p>Declared at: <a class="is-family-code" href="https://github.com/llvm/llvm-project/blob/release/10.x/llvm/include/llvm/Support/CrashRecoveryContext.h#L65">llvm/include/llvm/Support/CrashRecoveryContext.h:65</a></p><h3 id="DBBCE96D528F0259"><pre class="p-0 hdoc-pre-parent"><a class="hdoc-permalink-icon" href="#DBBCE96D528F0259">¶</a><code class="hdoc-function-code language-cpp">static void Enable()</code></pre></h3><h4>Description</h4><p>Enable crash recovery.</p><p>Declared at: <a class="is-family-code" href="https://github.com/llvm/llvm-project/blob/release/10.x/llvm/include/llvm/Support/CrashRecoveryContext.h#L62">llvm/include/llvm/Support/CrashRecoveryContext.h:62</a></p><h3 id="55891A235FF0252C"><pre class="p-0 hdoc-pre-parent"><a class="hdoc-permalink-icon" href="#55891A235FF0252C">¶</a><code class="hdoc-function-code language-cpp">static <a href="r8D13648F31258725.html">llvm::CrashRecoveryContext</a>* GetCurrent()</code></pre></h3><h4>Description</h4><p>Return the active context, if the code is currently executing in a thread which is in a protected context.</p><p>Declared at: <a class="is-family-code" href="https://github.com/llvm/llvm-project/blob/release/10.x/llvm/include/llvm/Support/CrashRecoveryContext.h#L69">llvm/include/llvm/Support/CrashRecoveryContext.h:69</a></p><h3 id="F2A921A5FD087C13"><pre class="p-0 hdoc-pre-parent"><a class="hdoc-permalink-icon" href="#F2A921A5FD087C13">¶</a><code class="hdoc-function-code language-cpp">void HandleExit(int RetCode)</code></pre></h3><h4>Description</h4><p>Explicitly trigger a crash recovery in the current process, and return failure from RunSafely(). This function does not return.</p><p>Declared at: <a class="is-family-code" href="https://github.com/llvm/llvm-project/blob/release/10.x/llvm/include/llvm/Support/CrashRecoveryContext.h#L103">llvm/include/llvm/Support/CrashRecoveryContext.h:103</a></p><h4>Parameters</h4><dl><dt class="is-family-code">int<b> RetCode</b></dt></dl><h3 id="B485719EAE246E14"><pre class="p-0 hdoc-pre-parent"><a class="hdoc-permalink-icon" href="#B485719EAE246E14">¶</a><code class="hdoc-function-code language-cpp">bool RunSafely(function_ref&lt;void()&gt; Fn)</code></pre></h3><h4>Description</h4><p>Execute the provided callback function (with the given arguments) in a protected context.</p><p>Declared at: <a class="is-family-code" href="https://github.com/llvm/llvm-project/blob/release/10.x/llvm/include/llvm/Support/CrashRecoveryContext.h#L81">llvm/include/llvm/Support/CrashRecoveryContext.h:81</a></p><h4>Parameters</h4><dl><dt class="is-family-code">function_ref&lt;void()&gt;<b> Fn</b></dt></dl><h4>Returns</h4><p>True if the function completed successfully, and false if the function crashed (or HandleCrash was called explicitly). Clients should make as little assumptions as possible about the program state when RunSafely has returned false.</p><h3 id="AED8EA674104682C"><pre class="p-0 hdoc-pre-parent"><a class="hdoc-permalink-icon" href="#AED8EA674104682C">¶</a><code class="hdoc-function-code language-cpp">bool RunSafely(void (*)(void*) Fn, void* UserData)</code></pre></h3><p>Declared at: <a class="is-family-code" href="https://github.com/llvm/llvm-project/blob/release/10.x/llvm/include/llvm/Support/CrashRecoveryContext.h#L82">llvm/include/llvm/Support/CrashRecoveryContext.h:82</a></p><h4>Parameters</h4><dl><dt class="is-family-code">void (*)(void*)<b> Fn</b></dt><dt class="is-family-code">void*<b> UserData</b></dt></dl><h3 id="23268F157FDC356C"><pre class="p-0 hdoc-pre-parent"><a class="hdoc-permalink-icon" href="#23268F157FDC356C">¶</a><code class="hdoc-function-code language-cpp">bool RunSafelyOnThread(
    function_ref&lt;void()&gt;,
    unsigned int RequestedStackSize = 0)</code></pre></h3><h4>Description</h4><p>Execute the provide callback function (with the given arguments) in a protected context which is run in another thread (optionally with a requested stack size). See RunSafely() and llvm_execute_on_thread(). On Darwin, if PRIO_DARWIN_BG is set on the calling thread, it will be propagated to the new thread as well.</p><p>Declared at: <a class="is-family-code" href="https://github.com/llvm/llvm-project/blob/release/10.x/llvm/include/llvm/Support/CrashRecoveryContext.h#L94">llvm/include/llvm/Support/CrashRecoveryContext.h:94</a></p><h4>Parameters</h4><dl><dt class="is-family-code">function_ref&lt;void()&gt;<b> </b></dt><dt class="is-family-code">unsigned int<b> RequestedStackSize</b> = 0</dt></dl><h3 id="0E71A811A04836BD"><pre class="p-0 hdoc-pre-parent"><a class="hdoc-permalink-icon" href="#0E71A811A04836BD">¶</a><code class="hdoc-function-code language-cpp">bool RunSafelyOnThread(
    void (*)(void*) Fn,
    void* UserData,
    unsigned int RequestedStackSize = 0)</code></pre></h3><p>Declared at: <a class="is-family-code" href="https://github.com/llvm/llvm-project/blob/release/10.x/llvm/include/llvm/Support/CrashRecoveryContext.h#L95">llvm/include/llvm/Support/CrashRecoveryContext.h:95</a></p><h4>Parameters</h4><dl><dt class="is-family-code">void (*)(void*)<b> Fn</b></dt><dt class="is-family-code">void*<b> UserData</b></dt><dt class="is-family-code">unsigned int<b> RequestedStackSize</b> = 0</dt></dl><h3 id="D50F9E32146E62A3"><pre class="p-0 hdoc-pre-parent"><a class="hdoc-permalink-icon" href="#D50F9E32146E62A3">¶</a><code class="hdoc-function-code language-cpp">static bool isRecoveringFromCrash()</code></pre></h3><h4>Description</h4><p>Return true if the current thread is recovering from a crash.</p><p>Declared at: <a class="is-family-code" href="https://github.com/llvm/llvm-project/blob/release/10.x/llvm/include/llvm/Support/CrashRecoveryContext.h#L72">llvm/include/llvm/Support/CrashRecoveryContext.h:72</a></p><h3 id="3B1D290790A1EC46"><pre class="p-0 hdoc-pre-parent"><a class="hdoc-permalink-icon" href="#3B1D290790A1EC46">¶</a><code class="hdoc-function-code language-cpp">void registerCleanup(
    <a href="rBC7B76538CB437B8.html">llvm::CrashRecoveryContextCleanup</a>* cleanup)</code></pre></h3><h4>Description</h4><p>Register cleanup handler, which is used when the recovery context is finished. The recovery context owns the handler.</p><p>Declared at: <a class="is-family-code" href="https://github.com/llvm/llvm-project/blob/release/10.x/llvm/include/llvm/Support/CrashRecoveryContext.h#L57">llvm/include/llvm/Support/CrashRecoveryContext.h:57</a></p><h4>Parameters</h4><dl><dt class="is-family-code"><a href="rBC7B76538CB437B8.html">llvm::CrashRecoveryContextCleanup</a>*<b> cleanup</b></dt></dl><h3 id="87C48B5F40BB1A13"><pre class="p-0 hdoc-pre-parent"><a class="hdoc-permalink-icon" href="#87C48B5F40BB1A13">¶</a><code class="hdoc-function-code language-cpp">void unregisterCleanup(
    <a href="rBC7B76538CB437B8.html">llvm::CrashRecoveryContextCleanup</a>* cleanup)</code></pre></h3><p>Declared at: <a class="is-family-code" href="https://github.com/llvm/llvm-project/blob/release/10.x/llvm/include/llvm/Support/CrashRecoveryContext.h#L59">llvm/include/llvm/Support/CrashRecoveryContext.h:59</a></p><h4>Parameters</h4><dl><dt class="is-family-code"><a href="rBC7B76538CB437B8.html">llvm::CrashRecoveryContextCleanup</a>*<b> cleanup</b></dt></dl><h3 id="B4C0075EEA6E8F55"><pre class="p-0 hdoc-pre-parent"><a class="hdoc-permalink-icon" href="#B4C0075EEA6E8F55">¶</a><code class="hdoc-function-code language-cpp">~CrashRecoveryContext()</code></pre></h3><p>Declared at: <a class="is-family-code" href="https://github.com/llvm/llvm-project/blob/release/10.x/llvm/include/llvm/Support/CrashRecoveryContext.h#L52">llvm/include/llvm/Support/CrashRecoveryContext.h:52</a></p></main></div></div></div></section></div><footer class="footer"><p>Documentation for LLVM 10.0.0.</p><p>Generated by <a href="https://hdoc.io/">hdoc</a> version 1.4.0-hdocInternal on 2022-12-14T09:44:14 UTC.</p><p class="has-text-grey-light">19AD43E11B2996</p></footer></body></html>