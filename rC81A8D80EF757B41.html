<!DOCTYPE html><html><head><meta charset="utf-8"></meta><meta content="width=device-width, initial-scale=1" name="viewport"></meta><title>class LineTable: LLVM 10.0.0 documentation</title><link href="styles.css" rel="stylesheet"></link><script src="highlight.min.js"></script><script>hljs.highlightAll();</script><link href="katex.min.css" rel="stylesheet"></link><script src="katex.min.js"></script><script src="auto-render.min.js"></script><script>
    document.addEventListener("DOMContentLoaded", function() {
      renderMathInElement(document.body, {
        delimiters: [
          {left: '$$', right: '$$', display: true},
          {left: '$', right: '$', display: false},
        ],
      });
    });
  </script><link href="apple-touch-icon.png" sizes="180x180" rel="apple-touch-icon"></link><link href="favicon-32x32.png" sizes="32x32" type="image/png" rel="icon"></link><link href="favicon-16x16.png" sizes="16x16" type="image/png" rel="icon"></link></head><body><div id="wrapper"><section class="section"><div class="container"><div class="columns"><aside class="column is-one-fifth"><ul class="menu-list"><p class="is-size-4">LLVM 10.0.0</p><p class="menu-label">Navigation</p><li><a href="index.html">Home</a></li><li><a href="search.html">Search</a></li><li><a href="https://github.com/llvm/llvm-project/">Repository</a></li><li><a href="https://hdoc.io">Made with hdoc</a></li><p class="menu-label">API Documentation</p><li><a href="functions.html">Functions</a></li><li><a href="records.html">Records</a></li><li><a href="enums.html">Enums</a></li><li><a href="namespaces.html">Namespaces</a></li></ul></aside><div class="column" style="overflow-x: auto"><nav class="breadcrumb has-arrow-separator" aria-label="breadcrumbs"><ul><li><a href="namespaces.html#00A4DA910CC17C2D"><span>namespace llvm</span></a></li><li><a href="namespaces.html#BF3258AEA677DB5D"><span>namespace gsym</span></a></li><li class="is-active"><a aria-current="pageC81A8D80EF757B41"><span>class LineTable</span></a></li></ul></nav><main class="content"><h1>class LineTable</h1><h2>Declaration</h2><pre class="p-0"><code class="hdoc-record-code language-cpp">class LineTable { /* full declaration omitted */ };</code></pre><h2>Description</h2><p>LineTable class contains deserialized versions of line tables for each function&apos;s address ranges. When saved to disk, the line table is encoded using a modified version of the DWARF line tables that only tracks address to source file and line. ENCODING The line table starts with a small prolog that contains the following values: ENCODING NAME        DESCRIPTION ======== =========== ==================================================== SLEB     MinDelta    The min line delta for special opcodes that  advance the address and line number. SLEB     MaxDelta    The max line delta for single byte opcodes that advance the address and line number. ULEB     FirstLine   The value of the first source line number to initialize the LineEntry with. Once these prolog items are read, we initialize a LineEntry struct with the start address of the function from the FunctionInfo&apos;s address range, a default file index of 1, and the line number set to &quot;FirstLine&quot; from the prolog above: LineEntry Row(BaseAddr, 1, FirstLine); The line table state machine is now initialized and ready to be parsed. The stream that follows this encodes the line entries in a compact form. Some opcodes cause &quot;Row&quot; to be modified and some opcodes may also push &quot;Row&quot; onto the end of the &quot;LineTable.Lines&quot; vector. The end result is a vector of LineEntry structs that is sorted in ascending address order. NORMAL OPCODES The opcodes 0 through 3 are normal in opcodes. Their encoding and descriptions are listed below: ENCODING ENUMERATION       VALUE DESCRIPTION ======== ================  ===== ======================================== LTOC_EndSequence  0x00  Parsing is done. ULEB     LTOC_SetFile      0x01  Row.File = ULEB ULEB     LTOC_AdvancePC    0x02  Row.Addr += ULEB, push &quot;Row&quot;. SLEB     LTOC_AdvanceLine  0x03  Row.Line += SLEB LTOC_FirstSpecial 0x04  First special opcode (see SPECIAL OPCODES below). SPECIAL OPCODES Opcodes LTOC_FirstSpecial through 255 are special opcodes that always increment both the Row.Addr and Row.Line and push &quot;Row&quot; onto the LineEntry.Lines array. They do this by using some of the bits to increment/decrement the source line number, and some of the bits to increment the address. Line numbers can go up or down when making line tables, where addresses always only increase since line tables are sorted by address. In order to calculate the amount to increment the line and address for these special opcodes, we calculate the number of values reserved for the line increment/decrement using the &quot;MinDelta&quot; and &quot;MaxDelta&quot; from the prolog: const int64_t LineRange = MaxDelta - MinDelta + 1; Then we can adjust the opcode to not include any of the normal opcodes: const uint8_t AdjustedOp = Opcode - LTOC_FirstSpecial; And we can calculate the line offset, and address offset: const int64_t LineDelta = MinDelta + (AdjustedOp % LineRange); const uint64_t AddrDelta = (AdjustedOp / LineRange); And use these to modify our &quot;Row&quot;: Row.Line += LineDelta; Row.Addr += AddrDelta; And push a row onto the line table: Lines.push_back(Row); This is verify similar to the way that DWARF encodes its line tables. The only difference is the DWARF line tables have more normal opcodes and the &quot;Row&quot; contains more members, like source column number, bools for end of prologue, beginnging of epilogue, is statement and many others. There are also more complex rules that happen for the extra normal opcodes. By leaving these extra opcodes out, we leave more bits for the special opcodes that allows us to encode line tables in fewer bytes than standard DWARF encodings. Opcodes that will push &quot;Row&quot; onto the LineEntry.Lines include the LTOC_AdvancePC opcode and all special opcodes. All other opcodes only modify the current &quot;Row&quot;, or cause the line table to end.</p><p>Declared at: <a class="is-family-code" href="https://github.com/llvm/llvm-project/blob/release/10.x/llvm/include/llvm/DebugInfo/GSYM/LineTable.h#L118">llvm/include/llvm/DebugInfo/GSYM/LineTable.h:118</a></p><h2>Method Overview</h2><ul><li class="is-family-code">public Collection::const_iterator  <a href="#DF89F41E9DB13589"><b>begin</b></a>() const</li><li class="is-family-code">public void  <a href="#390238E2B0D979FE"><b>clear</b></a>()</li><li class="is-family-code">public static llvm::Expected&lt;LineTable&gt;  <a href="#5CD1EC5CFA45C493"><b>decode</b></a>(llvm::DataExtractor &amp; Data, uint64_t BaseAddr)</li><li class="is-family-code">public bool  <a href="#DC390DCBAA9C95FE"><b>empty</b></a>() const</li><li class="is-family-code">public llvm::Error  <a href="#D8DB7EE32AD0F325"><b>encode</b></a>(llvm::gsym::FileWriter &amp; O, uint64_t BaseAddr) const</li><li class="is-family-code">public Collection::const_iterator  <a href="#A36F7F3D71FFB7DB"><b>end</b></a>() const</li><li class="is-family-code">public llvm::gsym::LineEntry &amp;  <a href="#174752EAA2CE6049"><b>get</b></a>(size_t i)</li><li class="is-family-code">public const llvm::gsym::LineEntry &amp;  <a href="#25ACED1E9FDE1C3B"><b>get</b></a>(size_t i) const</li><li class="is-family-code">public size_t  <a href="#EF0979679A3317A7"><b>isValid</b></a>() const</li><li class="is-family-code">public static Expected&lt;llvm::gsym::LineEntry&gt;  <a href="#7664BFDDE98BB4EB"><b>lookup</b></a>(llvm::DataExtractor &amp; Data, uint64_t BaseAddr, uint64_t Addr)</li><li class="is-family-code">public void  <a href="#A79830E54538FEC5"><b>push</b></a>(const llvm::gsym::LineEntry &amp; LE)</li><li class="is-family-code">public size_t  <a href="#1ED79DE142200CE4"><b>size</b></a>() const</li></ul><h2>Methods</h2><h3 id="DF89F41E9DB13589"><pre class="p-0 hdoc-pre-parent"><a class="hdoc-permalink-icon" href="#DF89F41E9DB13589">¶</a><code class="hdoc-function-code language-cpp">Collection::const_iterator begin() const</code></pre></h3><p>Declared at: <a class="is-family-code" href="https://github.com/llvm/llvm-project/blob/release/10.x/llvm/include/llvm/DebugInfo/GSYM/LineTable.h#L205">llvm/include/llvm/DebugInfo/GSYM/LineTable.h:205</a></p><h3 id="390238E2B0D979FE"><pre class="p-0 hdoc-pre-parent"><a class="hdoc-permalink-icon" href="#390238E2B0D979FE">¶</a><code class="hdoc-function-code language-cpp">void clear()</code></pre></h3><p>Declared at: <a class="is-family-code" href="https://github.com/llvm/llvm-project/blob/release/10.x/llvm/include/llvm/DebugInfo/GSYM/LineTable.h#L168">llvm/include/llvm/DebugInfo/GSYM/LineTable.h:168</a></p><h3 id="5CD1EC5CFA45C493"><pre class="p-0 hdoc-pre-parent"><a class="hdoc-permalink-icon" href="#5CD1EC5CFA45C493">¶</a><code class="hdoc-function-code language-cpp">static <a href="r004187BCD48C0729.html">llvm::Expected</a>&lt;LineTable&gt; decode(
    <a href="r5792405E0ED5001C.html">llvm::DataExtractor</a>&amp; Data,
    uint64_t BaseAddr)</code></pre></h3><h4>Description</h4><p>Decode an LineTable object from a binary data stream.</p><p>Declared at: <a class="is-family-code" href="https://github.com/llvm/llvm-project/blob/release/10.x/llvm/include/llvm/DebugInfo/GSYM/LineTable.h#L154">llvm/include/llvm/DebugInfo/GSYM/LineTable.h:154</a></p><h4>Parameters</h4><dl><dt class="is-family-code"><a href="r5792405E0ED5001C.html">llvm::DataExtractor</a>&amp;<b> Data</b></dt><dd>The binary stream to read the data from. This object must have the data for the LineTable object starting at offset zero. The data can contain more data than needed.</dd><dt class="is-family-code">uint64_t<b> BaseAddr</b></dt><dd>The base address to use when decoding the line table. This will be the FunctionInfo&apos;s start address and will be used to initialize the line table row prior to parsing any opcodes.</dd></dl><h4>Returns</h4><p>An LineTable or an error describing the issue that was encountered during decoding.</p><h3 id="DC390DCBAA9C95FE"><pre class="p-0 hdoc-pre-parent"><a class="hdoc-permalink-icon" href="#DC390DCBAA9C95FE">¶</a><code class="hdoc-function-code language-cpp">bool empty() const</code></pre></h3><p>Declared at: <a class="is-family-code" href="https://github.com/llvm/llvm-project/blob/release/10.x/llvm/include/llvm/DebugInfo/GSYM/LineTable.h#L167">llvm/include/llvm/DebugInfo/GSYM/LineTable.h:167</a></p><h3 id="D8DB7EE32AD0F325"><pre class="p-0 hdoc-pre-parent"><a class="hdoc-permalink-icon" href="#D8DB7EE32AD0F325">¶</a><code class="hdoc-function-code language-cpp"><a href="r40593E26768E0096.html">llvm::Error</a> encode(<a href="r8C7403547ECE28F8.html">llvm::gsym::FileWriter</a>&amp; O,
                   uint64_t BaseAddr) const</code></pre></h3><h4>Description</h4><p>Encode this LineTable object into FileWriter stream.</p><p>Declared at: <a class="is-family-code" href="https://github.com/llvm/llvm-project/blob/release/10.x/llvm/include/llvm/DebugInfo/GSYM/LineTable.h#L166">llvm/include/llvm/DebugInfo/GSYM/LineTable.h:166</a></p><h4>Parameters</h4><dl><dt class="is-family-code"><a href="r8C7403547ECE28F8.html">llvm::gsym::FileWriter</a>&amp;<b> O</b></dt><dd>The binary stream to write the data to at the current file position.</dd><dt class="is-family-code">uint64_t<b> BaseAddr</b></dt><dd>The base address to use when decoding the line table. This will be the FunctionInfo&apos;s start address.</dd></dl><h4>Returns</h4><p>An error object that indicates success or failure or the encoding process.</p><h3 id="A36F7F3D71FFB7DB"><pre class="p-0 hdoc-pre-parent"><a class="hdoc-permalink-icon" href="#A36F7F3D71FFB7DB">¶</a><code class="hdoc-function-code language-cpp">Collection::const_iterator end() const</code></pre></h3><p>Declared at: <a class="is-family-code" href="https://github.com/llvm/llvm-project/blob/release/10.x/llvm/include/llvm/DebugInfo/GSYM/LineTable.h#L206">llvm/include/llvm/DebugInfo/GSYM/LineTable.h:206</a></p><h3 id="174752EAA2CE6049"><pre class="p-0 hdoc-pre-parent"><a class="hdoc-permalink-icon" href="#174752EAA2CE6049">¶</a><code class="hdoc-function-code language-cpp"><a href="r5E79E196A833E16B.html">llvm::gsym::LineEntry</a>&amp; get(size_t i)</code></pre></h3><p>Declared at: <a class="is-family-code" href="https://github.com/llvm/llvm-project/blob/release/10.x/llvm/include/llvm/DebugInfo/GSYM/LineTable.h#L178">llvm/include/llvm/DebugInfo/GSYM/LineTable.h:178</a></p><h4>Parameters</h4><dl><dt class="is-family-code">size_t<b> i</b></dt></dl><h3 id="25ACED1E9FDE1C3B"><pre class="p-0 hdoc-pre-parent"><a class="hdoc-permalink-icon" href="#25ACED1E9FDE1C3B">¶</a><code class="hdoc-function-code language-cpp">const <a href="r5E79E196A833E16B.html">llvm::gsym::LineEntry</a>&amp; get(size_t i) const</code></pre></h3><p>Declared at: <a class="is-family-code" href="https://github.com/llvm/llvm-project/blob/release/10.x/llvm/include/llvm/DebugInfo/GSYM/LineTable.h#L182">llvm/include/llvm/DebugInfo/GSYM/LineTable.h:182</a></p><h4>Parameters</h4><dl><dt class="is-family-code">size_t<b> i</b></dt></dl><h3 id="EF0979679A3317A7"><pre class="p-0 hdoc-pre-parent"><a class="hdoc-permalink-icon" href="#EF0979679A3317A7">¶</a><code class="hdoc-function-code language-cpp">size_t isValid() const</code></pre></h3><p>Declared at: <a class="is-family-code" href="https://github.com/llvm/llvm-project/blob/release/10.x/llvm/include/llvm/DebugInfo/GSYM/LineTable.h#L172">llvm/include/llvm/DebugInfo/GSYM/LineTable.h:172</a></p><h3 id="7664BFDDE98BB4EB"><pre class="p-0 hdoc-pre-parent"><a class="hdoc-permalink-icon" href="#7664BFDDE98BB4EB">¶</a><code class="hdoc-function-code language-cpp">static <a href="r004187BCD48C0729.html">Expected</a>&lt;llvm::gsym::LineEntry&gt; lookup(
    <a href="r5792405E0ED5001C.html">llvm::DataExtractor</a>&amp; Data,
    uint64_t BaseAddr,
    uint64_t Addr)</code></pre></h3><h4>Description</h4><p>Lookup a single address within a line table&apos;s data. Clients have the option to decode an entire line table using LineTable::decode() or just find a single matching entry using this function. The benefit of using this function is that parsed LineEntry objects that do not match will not be stored in an array. This will avoid memory allocation costs and parsing can stop once a match has been found.</p><p>Declared at: <a class="is-family-code" href="https://github.com/llvm/llvm-project/blob/release/10.x/llvm/include/llvm/DebugInfo/GSYM/LineTable.h#L139">llvm/include/llvm/DebugInfo/GSYM/LineTable.h:139</a></p><h4>Parameters</h4><dl><dt class="is-family-code"><a href="r5792405E0ED5001C.html">llvm::DataExtractor</a>&amp;<b> Data</b></dt><dd>The binary stream to read the data from. This object must have the data for the LineTable object starting at offset zero. The data can contain more data than needed.</dd><dt class="is-family-code">uint64_t<b> BaseAddr</b></dt><dd>The base address to use when decoding the line table. This will be the FunctionInfo&apos;s start address and will be used to initialize the line table row prior to parsing any opcodes.</dd><dt class="is-family-code">uint64_t<b> Addr</b></dt></dl><h4>Returns</h4><p>An LineEntry object if a match is found, error otherwise.</p><h3 id="A79830E54538FEC5"><pre class="p-0 hdoc-pre-parent"><a class="hdoc-permalink-icon" href="#A79830E54538FEC5">¶</a><code class="hdoc-function-code language-cpp">void push(const <a href="r5E79E196A833E16B.html">llvm::gsym::LineEntry</a>&amp; LE)</code></pre></h3><p>Declared at: <a class="is-family-code" href="https://github.com/llvm/llvm-project/blob/release/10.x/llvm/include/llvm/DebugInfo/GSYM/LineTable.h#L169">llvm/include/llvm/DebugInfo/GSYM/LineTable.h:169</a></p><h4>Parameters</h4><dl><dt class="is-family-code">const <a href="r5E79E196A833E16B.html">llvm::gsym::LineEntry</a>&amp;<b> LE</b></dt></dl><h3 id="1ED79DE142200CE4"><pre class="p-0 hdoc-pre-parent"><a class="hdoc-permalink-icon" href="#1ED79DE142200CE4">¶</a><code class="hdoc-function-code language-cpp">size_t size() const</code></pre></h3><p>Declared at: <a class="is-family-code" href="https://github.com/llvm/llvm-project/blob/release/10.x/llvm/include/llvm/DebugInfo/GSYM/LineTable.h#L175">llvm/include/llvm/DebugInfo/GSYM/LineTable.h:175</a></p></main></div></div></div></section></div><footer class="footer"><p>Documentation for LLVM 10.0.0.</p><p>Generated by <a href="https://hdoc.io/">hdoc</a> version 1.4.0-hdocInternal on 2022-12-14T09:44:14 UTC.</p><p class="has-text-grey-light">19AD43E11B2996</p></footer></body></html>