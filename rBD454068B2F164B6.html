<!DOCTYPE html><html><head><meta charset="utf-8"></meta><meta content="width=device-width, initial-scale=1" name="viewport"></meta><title>class LoopVersioning: LLVM 10.0.0 documentation</title><link href="styles.css" rel="stylesheet"></link><script src="highlight.min.js"></script><script>hljs.highlightAll();</script><link href="katex.min.css" rel="stylesheet"></link><script src="katex.min.js"></script><script src="auto-render.min.js"></script><script>
    document.addEventListener("DOMContentLoaded", function() {
      renderMathInElement(document.body, {
        delimiters: [
          {left: '$$', right: '$$', display: true},
          {left: '$', right: '$', display: false},
        ],
      });
    });
  </script><link href="apple-touch-icon.png" sizes="180x180" rel="apple-touch-icon"></link><link href="favicon-32x32.png" sizes="32x32" type="image/png" rel="icon"></link><link href="favicon-16x16.png" sizes="16x16" type="image/png" rel="icon"></link></head><body><div id="wrapper"><section class="section"><div class="container"><div class="columns"><aside class="column is-one-fifth"><ul class="menu-list"><p class="is-size-4">LLVM 10.0.0</p><p class="menu-label">Navigation</p><li><a href="index.html">Home</a></li><li><a href="search.html">Search</a></li><li><a href="https://github.com/llvm/llvm-project/">Repository</a></li><li><a href="https://hdoc.io">Made with hdoc</a></li><p class="menu-label">API Documentation</p><li><a href="functions.html">Functions</a></li><li><a href="records.html">Records</a></li><li><a href="enums.html">Enums</a></li><li><a href="namespaces.html">Namespaces</a></li></ul></aside><div class="column" style="overflow-x: auto"><nav class="breadcrumb has-arrow-separator" aria-label="breadcrumbs"><ul><li><a href="namespaces.html#00A4DA910CC17C2D"><span>namespace llvm</span></a></li><li class="is-active"><a aria-current="pageBD454068B2F164B6"><span>class LoopVersioning</span></a></li></ul></nav><main class="content"><h1>class LoopVersioning</h1><h2>Declaration</h2><pre class="p-0"><code class="hdoc-record-code language-cpp">class LoopVersioning { /* full declaration omitted */ };</code></pre><h2>Description</h2><p>This class emits a version of the loop where run-time checks ensure that may-alias pointers can&apos;t overlap. It currently only supports single-exit loops and assumes that the loop already has a preheader.</p><p>Declared at: <a class="is-family-code" href="https://github.com/llvm/llvm-project/blob/release/10.x/llvm/include/llvm/Transforms/Utils/LoopVersioning.h#L35">llvm/include/llvm/Transforms/Utils/LoopVersioning.h:35</a></p><h2>Method Overview</h2><ul><li class="is-family-code">public  <a href="#E0CD109CD668833F"><b>LoopVersioning</b></a>(const llvm::LoopAccessInfo &amp; LAI, llvm::Loop * L, llvm::LoopInfo * LI, llvm::DominatorTree * DT, llvm::ScalarEvolution * SE, bool UseLAIChecks = true)</li><li class="is-family-code">public void  <a href="#2AD6DC0D5041C8FE"><b>annotateInstWithNoAlias</b></a>(llvm::Instruction * VersionedInst, const llvm::Instruction * OrigInst)</li><li class="is-family-code">public void  <a href="#5AB009539FAF0A90"><b>annotateLoopWithNoAlias</b></a>()</li><li class="is-family-code">public llvm::Loop *  <a href="#A9A4316BD9AEE358"><b>getNonVersionedLoop</b></a>()</li><li class="is-family-code">public llvm::Loop *  <a href="#0424586C5FCFEE66"><b>getVersionedLoop</b></a>()</li><li class="is-family-code">public void  <a href="#D66C47A1C219F3CC"><b>prepareNoAliasMetadata</b></a>()</li><li class="is-family-code">public void  <a href="#C38BAB989D965A1F"><b>setAliasChecks</b></a>(SmallVector&lt;RuntimePointerChecking::PointerCheck, 4&gt; Checks)</li><li class="is-family-code">public void  <a href="#398E7B2C90C0DEAE"><b>setSCEVChecks</b></a>(llvm::SCEVUnionPredicate Check)</li><li class="is-family-code">public void  <a href="#10A9E1B9F5B3E80E"><b>versionLoop</b></a>()</li><li class="is-family-code">public void  <a href="#7C7C0D1E41814877"><b>versionLoop</b></a>(const SmallVectorImpl&lt;llvm::Instruction *&gt; &amp; DefsUsedOutside)</li></ul><h2>Methods</h2><h3 id="E0CD109CD668833F"><pre class="p-0 hdoc-pre-parent"><a class="hdoc-permalink-icon" href="#E0CD109CD668833F">¶</a><code class="hdoc-function-code language-cpp">LoopVersioning(const <a href="r5C691A16B4B13AC5.html">llvm::LoopAccessInfo</a>&amp; LAI,
               <a href="r210AF08D1E341AC3.html">llvm::Loop</a>* L,
               <a href="r289205FCE270195C.html">llvm::LoopInfo</a>* LI,
               <a href="r597D5CB55B73E338.html">llvm::DominatorTree</a>* DT,
               <a href="r0D901B7ED6429B0A.html">llvm::ScalarEvolution</a>* SE,
               bool UseLAIChecks = true)</code></pre></h3><h4>Description</h4><p>Expects LoopAccessInfo, Loop, LoopInfo, DominatorTree as input. It uses runtime check provided by the user. If \p UseLAIChecks is true, we will retain the default checks made by LAI. Otherwise, construct an object having no checks and we expect the user to add them.</p><p>Declared at: <a class="is-family-code" href="https://github.com/llvm/llvm-project/blob/release/10.x/llvm/include/llvm/Transforms/Utils/LoopVersioning.h#L41">llvm/include/llvm/Transforms/Utils/LoopVersioning.h:41</a></p><h4>Parameters</h4><dl><dt class="is-family-code">const <a href="r5C691A16B4B13AC5.html">llvm::LoopAccessInfo</a>&amp;<b> LAI</b></dt><dt class="is-family-code"><a href="r210AF08D1E341AC3.html">llvm::Loop</a>*<b> L</b></dt><dt class="is-family-code"><a href="r289205FCE270195C.html">llvm::LoopInfo</a>*<b> LI</b></dt><dt class="is-family-code"><a href="r597D5CB55B73E338.html">llvm::DominatorTree</a>*<b> DT</b></dt><dt class="is-family-code"><a href="r0D901B7ED6429B0A.html">llvm::ScalarEvolution</a>*<b> SE</b></dt><dt class="is-family-code">bool<b> UseLAIChecks</b> = true</dt></dl><h3 id="2AD6DC0D5041C8FE"><pre class="p-0 hdoc-pre-parent"><a class="hdoc-permalink-icon" href="#2AD6DC0D5041C8FE">¶</a><code class="hdoc-function-code language-cpp">void annotateInstWithNoAlias(
    <a href="rE266D8602316BABC.html">llvm::Instruction</a>* VersionedInst,
    const <a href="rE266D8602316BABC.html">llvm::Instruction</a>* OrigInst)</code></pre></h3><h4>Description</h4><p>Add the noalias annotations to \p VersionedInst. \p OrigInst is the instruction corresponding to \p VersionedInst in the original loop.  Initialize the aliasing scopes with prepareNoAliasMetadata once before this can be called.</p><p>Declared at: <a class="is-family-code" href="https://github.com/llvm/llvm-project/blob/release/10.x/llvm/include/llvm/Transforms/Utils/LoopVersioning.h#L96">llvm/include/llvm/Transforms/Utils/LoopVersioning.h:96</a></p><h4>Parameters</h4><dl><dt class="is-family-code"><a href="rE266D8602316BABC.html">llvm::Instruction</a>*<b> VersionedInst</b></dt><dt class="is-family-code">const <a href="rE266D8602316BABC.html">llvm::Instruction</a>*<b> OrigInst</b></dt></dl><h3 id="5AB009539FAF0A90"><pre class="p-0 hdoc-pre-parent"><a class="hdoc-permalink-icon" href="#5AB009539FAF0A90">¶</a><code class="hdoc-function-code language-cpp">void annotateLoopWithNoAlias()</code></pre></h3><h4>Description</h4><p>Annotate memory instructions in the versioned loop with no-alias metadata based on the memchecks issued. This is just wrapper that calls prepareNoAliasMetadata and annotateInstWithNoAlias on the instructions of the versioned loop.</p><p>Declared at: <a class="is-family-code" href="https://github.com/llvm/llvm-project/blob/release/10.x/llvm/include/llvm/Transforms/Utils/LoopVersioning.h#L85">llvm/include/llvm/Transforms/Utils/LoopVersioning.h:85</a></p><h3 id="A9A4316BD9AEE358"><pre class="p-0 hdoc-pre-parent"><a class="hdoc-permalink-icon" href="#A9A4316BD9AEE358">¶</a><code class="hdoc-function-code language-cpp"><a href="r210AF08D1E341AC3.html">llvm::Loop</a>* getNonVersionedLoop()</code></pre></h3><h4>Description</h4><p>Returns the fall-back loop.  Control flows here if pointers in the loop may alias (i.e. one of the memchecks failed).</p><p>Declared at: <a class="is-family-code" href="https://github.com/llvm/llvm-project/blob/release/10.x/llvm/include/llvm/Transforms/Utils/LoopVersioning.h#L71">llvm/include/llvm/Transforms/Utils/LoopVersioning.h:71</a></p><h3 id="0424586C5FCFEE66"><pre class="p-0 hdoc-pre-parent"><a class="hdoc-permalink-icon" href="#0424586C5FCFEE66">¶</a><code class="hdoc-function-code language-cpp"><a href="r210AF08D1E341AC3.html">llvm::Loop</a>* getVersionedLoop()</code></pre></h3><h4>Description</h4><p>Returns the versioned loop.  Control flows here if pointers in the loop don&apos;t alias (i.e. all memchecks passed).  (This loop is actually the same as the original loop that we got constructed with.)</p><p>Declared at: <a class="is-family-code" href="https://github.com/llvm/llvm-project/blob/release/10.x/llvm/include/llvm/Transforms/Utils/LoopVersioning.h#L67">llvm/include/llvm/Transforms/Utils/LoopVersioning.h:67</a></p><h3 id="D66C47A1C219F3CC"><pre class="p-0 hdoc-pre-parent"><a class="hdoc-permalink-icon" href="#D66C47A1C219F3CC">¶</a><code class="hdoc-function-code language-cpp">void prepareNoAliasMetadata()</code></pre></h3><h4>Description</h4><p>Set up the aliasing scopes based on the memchecks.  This needs to be called before the first call to annotateInstWithNoAlias.</p><p>Declared at: <a class="is-family-code" href="https://github.com/llvm/llvm-project/blob/release/10.x/llvm/include/llvm/Transforms/Utils/LoopVersioning.h#L89">llvm/include/llvm/Transforms/Utils/LoopVersioning.h:89</a></p><h3 id="C38BAB989D965A1F"><pre class="p-0 hdoc-pre-parent"><a class="hdoc-permalink-icon" href="#C38BAB989D965A1F">¶</a><code class="hdoc-function-code language-cpp">void setAliasChecks(
    <a href="r62CD0592E97953B6.html">SmallVector</a>&lt;
        RuntimePointerChecking::PointerCheck,
        4&gt; Checks)</code></pre></h3><h4>Description</h4><p>Sets the runtime alias checks for versioning the loop.</p><p>Declared at: <a class="is-family-code" href="https://github.com/llvm/llvm-project/blob/release/10.x/llvm/include/llvm/Transforms/Utils/LoopVersioning.h#L74">llvm/include/llvm/Transforms/Utils/LoopVersioning.h:74</a></p><h4>Parameters</h4><dl><dt class="is-family-code"><a href="r62CD0592E97953B6.html">SmallVector</a>&lt;RuntimePointerChecking::PointerCheck,
            4&gt;<b> Checks</b></dt></dl><h3 id="398E7B2C90C0DEAE"><pre class="p-0 hdoc-pre-parent"><a class="hdoc-permalink-icon" href="#398E7B2C90C0DEAE">¶</a><code class="hdoc-function-code language-cpp">void setSCEVChecks(<a href="r54D1A136CCE6B02F.html">llvm::SCEVUnionPredicate</a> Check)</code></pre></h3><h4>Description</h4><p>Sets the runtime SCEV checks for versioning the loop.</p><p>Declared at: <a class="is-family-code" href="https://github.com/llvm/llvm-project/blob/release/10.x/llvm/include/llvm/Transforms/Utils/LoopVersioning.h#L78">llvm/include/llvm/Transforms/Utils/LoopVersioning.h:78</a></p><h4>Parameters</h4><dl><dt class="is-family-code"><a href="r54D1A136CCE6B02F.html">llvm::SCEVUnionPredicate</a><b> Check</b></dt></dl><h3 id="10A9E1B9F5B3E80E"><pre class="p-0 hdoc-pre-parent"><a class="hdoc-permalink-icon" href="#10A9E1B9F5B3E80E">¶</a><code class="hdoc-function-code language-cpp">void versionLoop()</code></pre></h3><h4>Description</h4><p>Performs the CFG manipulation part of versioning the loop including the DominatorTree and LoopInfo updates. The loop that was used to construct the class will be the &quot;versioned&quot; loop i.e. the loop that will receive control if all the memchecks pass. This allows the loop transform pass to operate on the same loop regardless of whether versioning was necessary or not: for each loop L: analyze L if versioning is necessary version L transform L</p><p>Declared at: <a class="is-family-code" href="https://github.com/llvm/llvm-project/blob/release/10.x/llvm/include/llvm/Transforms/Utils/LoopVersioning.h#L58">llvm/include/llvm/Transforms/Utils/LoopVersioning.h:58</a></p><h3 id="7C7C0D1E41814877"><pre class="p-0 hdoc-pre-parent"><a class="hdoc-permalink-icon" href="#7C7C0D1E41814877">¶</a><code class="hdoc-function-code language-cpp">void versionLoop(
    const <a href="r6CBD92E95A65634C.html">SmallVectorImpl</a>&lt;llvm::Instruction*&gt;&amp;
        DefsUsedOutside)</code></pre></h3><h4>Description</h4><p>Same but if the client has already precomputed the set of values used outside the loop, this API will allows passing that.</p><p>Declared at: <a class="is-family-code" href="https://github.com/llvm/llvm-project/blob/release/10.x/llvm/include/llvm/Transforms/Utils/LoopVersioning.h#L62">llvm/include/llvm/Transforms/Utils/LoopVersioning.h:62</a></p><h4>Parameters</h4><dl><dt class="is-family-code">const <a href="r6CBD92E95A65634C.html">SmallVectorImpl</a>&lt;llvm::Instruction*&gt;&amp;<b> DefsUsedOutside</b></dt></dl></main></div></div></div></section></div><footer class="footer"><p>Documentation for LLVM 10.0.0.</p><p>Generated by <a href="https://hdoc.io/">hdoc</a> version 1.4.0-hdocInternal on 2022-12-14T09:44:14 UTC.</p><p class="has-text-grey-light">19AD43E11B2996</p></footer></body></html>