<!DOCTYPE html><html><head><meta charset="utf-8"></meta><meta content="width=device-width, initial-scale=1" name="viewport"></meta><title>class SampleProfileReaderBinary: LLVM 10.0.0 documentation</title><link href="styles.css" rel="stylesheet"></link><script src="highlight.min.js"></script><script>hljs.highlightAll();</script><link href="katex.min.css" rel="stylesheet"></link><script src="katex.min.js"></script><script src="auto-render.min.js"></script><script>
    document.addEventListener("DOMContentLoaded", function() {
      renderMathInElement(document.body, {
        delimiters: [
          {left: '$$', right: '$$', display: true},
          {left: '$', right: '$', display: false},
        ],
      });
    });
  </script><link href="apple-touch-icon.png" sizes="180x180" rel="apple-touch-icon"></link><link href="favicon-32x32.png" sizes="32x32" type="image/png" rel="icon"></link><link href="favicon-16x16.png" sizes="16x16" type="image/png" rel="icon"></link></head><body><div id="wrapper"><section class="section"><div class="container"><div class="columns"><aside class="column is-one-fifth"><ul class="menu-list"><p class="is-size-4">LLVM 10.0.0</p><p class="menu-label">Navigation</p><li><a href="index.html">Home</a></li><li><a href="search.html">Search</a></li><li><a href="https://github.com/llvm/llvm-project/">Repository</a></li><li><a href="https://hdoc.io">Made with hdoc</a></li><p class="menu-label">API Documentation</p><li><a href="functions.html">Functions</a></li><li><a href="records.html">Records</a></li><li><a href="enums.html">Enums</a></li><li><a href="namespaces.html">Namespaces</a></li></ul></aside><div class="column" style="overflow-x: auto"><nav class="breadcrumb has-arrow-separator" aria-label="breadcrumbs"><ul><li><a href="namespaces.html#00A4DA910CC17C2D"><span>namespace llvm</span></a></li><li><a href="namespaces.html#9F885E681E5C88EE"><span>namespace sampleprof</span></a></li><li class="is-active"><a aria-current="pageB586D9ABAB0CE7CF"><span>class SampleProfileReaderBinary</span></a></li></ul></nav><main class="content"><h1>class SampleProfileReaderBinary</h1><h2>Declaration</h2><pre class="p-0"><code class="hdoc-record-code language-cpp">class SampleProfileReaderBinary : public SampleProfileReader { /* full declaration omitted */ };</code></pre><h2>Description</h2><p>Sample-based profile reader. Each profile contains sample counts for all the functions executed. Inside each function, statements are annotated with the collected samples on all the instructions associated with that statement. For this to produce meaningful data, the program needs to be compiled with some debug information (at minimum, line numbers: -gline-tables-only). Otherwise, it will be impossible to match IR instructions to the line numbers collected by the profiler. From the profile file, we are interested in collecting the following information: * A list of functions included in the profile (mangled names). * For each function F: 1. The total number of samples collected in F. 2. The samples collected at each line in F. To provide some protection against source code shuffling, line numbers should be relative to the start of the function. The reader supports two file formats: text and binary. The text format is useful for debugging and testing, while the binary format is more compact and I/O efficient. They can both be used interchangeably.</p><p>Declared at: <a class="is-family-code" href="https://github.com/llvm/llvm-project/blob/release/10.x/llvm/include/llvm/ProfileData/SampleProfReader.h#L469">llvm/include/llvm/ProfileData/SampleProfReader.h:469</a></p><p>Inherits from: <a href="r083D117B30C9A9CA.html">SampleProfileReader</a></p><h2>Member Variables</h2><dl><dt class="is-family-code" id="var_Data">protected  const uint8_t* <b>Data</b> = nullptr</dt><dd>Points to the current location in the buffer.</dd><dt class="is-family-code" id="var_End">protected  const uint8_t* <b>End</b> = nullptr</dt><dd>Points to the end of the buffer.</dd><dt class="is-family-code" id="var_NameTable">protected  <a href="https://en.cppreference.com/w/cpp/container/vector">std::vector</a>&lt;StringRef&gt; <b>NameTable</b></dt><dd>Function name table.</dd></dl><p>Inherited from <a href="r083D117B30C9A9CA.html">SampleProfileReader</a>:</p><dl><dt class="is-family-code"><a href="r083D117B30C9A9CA.html#var_Profiles">protected <b>Profiles</b></a></dt><dt class="is-family-code"><a href="r083D117B30C9A9CA.html#var_Ctx">protected <b>Ctx</b></a></dt><dt class="is-family-code"><a href="r083D117B30C9A9CA.html#var_Buffer">protected <b>Buffer</b></a></dt><dt class="is-family-code"><a href="r083D117B30C9A9CA.html#var_Summary">protected <b>Summary</b></a></dt><dt class="is-family-code"><a href="r083D117B30C9A9CA.html#var_Remapper">protected <b>Remapper</b></a></dt><dt class="is-family-code"><a href="r083D117B30C9A9CA.html#var_Format">protected <b>Format</b></a> = SPF_None</dt></dl><h2>Method Overview</h2><ul><li class="is-family-code">public  <a href="#D708516C8FF4FA4E"><b>SampleProfileReaderBinary</b></a>(std::unique_ptr&lt;MemoryBuffer&gt; B, llvm::LLVMContext &amp; C, llvm::sampleprof::SampleProfileFormat Format = SPF_None)</li><li class="is-family-code">protected bool  <a href="#DCEE2903FBA1E3B8"><b>at_eof</b></a>() const</li><li class="is-family-code">public virtual std::vector&lt;StringRef&gt; *  <a href="#973ADA4B18473A4A"><b>getNameTable</b></a>()</li><li class="is-family-code">protected std::error_code  <a href="#EADB25CDCADED411"><b>readFuncProfile</b></a>(const uint8_t * Start)</li><li class="is-family-code">public virtual std::error_code  <a href="#066E2C3FC5C24BC3"><b>readHeader</b></a>()</li><li class="is-family-code">public std::error_code  <a href="#87F3BACB9971FC19"><b>readImpl</b></a>()</li><li class="is-family-code">protected std::error_code  <a href="#BBC7C596D5443EA4"><b>readMagicIdent</b></a>()</li><li class="is-family-code">protected virtual std::error_code  <a href="#982AB04AE24EE73A"><b>readNameTable</b></a>()</li><li class="is-family-code">protected template &lt;typename T&gt;ErrorOr&lt;T&gt;  <a href="#E27B8DDF4E268646"><b>readNumber</b></a>()</li><li class="is-family-code">protected std::error_code  <a href="#4837EC0CF1B49EA4"><b>readProfile</b></a>(llvm::sampleprof::FunctionSamples &amp; FProfile)</li><li class="is-family-code">protected ErrorOr&lt;llvm::StringRef&gt;  <a href="#C1BC3BEC28C03F06"><b>readString</b></a>()</li><li class="is-family-code">protected virtual ErrorOr&lt;llvm::StringRef&gt;  <a href="#4CEE879EA321ECDA"><b>readStringFromTable</b></a>()</li><li class="is-family-code">protected template &lt;typename T&gt;inline ErrorOr&lt;uint32_t&gt;  <a href="#F710D9F1A0510637"><b>readStringIndex</b></a>(T &amp; Table)</li><li class="is-family-code">protected std::error_code  <a href="#9214B46A860DE566"><b>readSummary</b></a>()</li><li class="is-family-code">protected template &lt;typename T&gt;ErrorOr&lt;T&gt;  <a href="#0E2E70F3E29A6455"><b>readUnencodedNumber</b></a>()</li></ul><p>Inherited from <a href="r083D117B30C9A9CA.html">SampleProfileReader</a>:</p><ul><li class="is-family-code"><a href="r083D117B30C9A9CA.html#C2D62FA9142F952F">public <b>collectFuncsFrom</b></a></li><li class="is-family-code"><a href="r083D117B30C9A9CA.html#BE6693C7E1A603E3">protected <b>computeSummary</b></a></li><li class="is-family-code"><a href="r083D117B30C9A9CA.html#AD1D27D05DC0B3D3">public <b>create</b></a></li><li class="is-family-code"><a href="r083D117B30C9A9CA.html#91368375C709FC78">public <b>create</b></a></li><li class="is-family-code"><a href="r083D117B30C9A9CA.html#90FD6D454B6A01CA">public <b>dump</b></a></li><li class="is-family-code"><a href="r083D117B30C9A9CA.html#764EAB5EBE1293A9">public <b>dumpFunctionProfile</b></a></li><li class="is-family-code"><a href="r083D117B30C9A9CA.html#065476C0F72F53CE">public <b>dumpSectionInfo</b></a></li><li class="is-family-code"><a href="r083D117B30C9A9CA.html#95C0E8D8D38CD14E">public <b>getBuffer</b></a></li><li class="is-family-code"><a href="r083D117B30C9A9CA.html#D5080D6C6B56A3C9">public <b>getFormat</b></a></li><li class="is-family-code"><a href="r083D117B30C9A9CA.html#AAB87FFDA49B7614">public <b>getNameTable</b></a></li><li class="is-family-code"><a href="r083D117B30C9A9CA.html#4E73C7A91D32B93C">public <b>getOrCreateSamplesFor</b></a></li><li class="is-family-code"><a href="r083D117B30C9A9CA.html#9F3B61F25BD1A8F2">public <b>getProfileSymbolList</b></a></li><li class="is-family-code"><a href="r083D117B30C9A9CA.html#DEFDE17DBF5C1783">public <b>getProfiles</b></a></li><li class="is-family-code"><a href="r083D117B30C9A9CA.html#EC3CFE7105031B18">public <b>getSamplesFor</b></a></li><li class="is-family-code"><a href="r083D117B30C9A9CA.html#83DC29D22713674D">public <b>getSamplesFor</b></a></li><li class="is-family-code"><a href="r083D117B30C9A9CA.html#83D5B331AFE57B45">public <b>getSummary</b></a></li><li class="is-family-code"><a href="r083D117B30C9A9CA.html#D12B5A589BAB230A">public <b>read</b></a></li><li class="is-family-code"><a href="r083D117B30C9A9CA.html#85975E3A89FE0CBF">public <b>readHeader</b></a></li><li class="is-family-code"><a href="r083D117B30C9A9CA.html#D16245A7852645A7">public <b>readImpl</b></a></li><li class="is-family-code"><a href="r083D117B30C9A9CA.html#CEF45989C3A14DF2">public <b>reportError</b></a></li><li class="is-family-code"><a href="r083D117B30C9A9CA.html#42FCD96F278CB921">protected <b>takeSummary</b></a></li></ul><h2>Methods</h2><h3 id="D708516C8FF4FA4E"><pre class="p-0 hdoc-pre-parent"><a class="hdoc-permalink-icon" href="#D708516C8FF4FA4E">Â¶</a><code class="hdoc-function-code language-cpp">SampleProfileReaderBinary(
    <a href="https://en.cppreference.com/w/cpp/memory/unique_ptr">std::unique_ptr</a>&lt;MemoryBuffer&gt; B,
    <a href="rB8F46D3CD599E2BD.html">llvm::LLVMContext</a>&amp; C,
    llvm::sampleprof::SampleProfileFormat Format =
        SPF_None)</code></pre></h3><p>Declared at: <a class="is-family-code" href="https://github.com/llvm/llvm-project/blob/release/10.x/llvm/include/llvm/ProfileData/SampleProfReader.h#L471">llvm/include/llvm/ProfileData/SampleProfReader.h:471</a></p><h4>Parameters</h4><dl><dt class="is-family-code"><a href="https://en.cppreference.com/w/cpp/memory/unique_ptr">std::unique_ptr</a>&lt;MemoryBuffer&gt;<b> B</b></dt><dt class="is-family-code"><a href="rB8F46D3CD599E2BD.html">llvm::LLVMContext</a>&amp;<b> C</b></dt><dt class="is-family-code">llvm::sampleprof::SampleProfileFormat<b> Format</b> = SPF_None</dt></dl><h3 id="DCEE2903FBA1E3B8"><pre class="p-0 hdoc-pre-parent"><a class="hdoc-permalink-icon" href="#DCEE2903FBA1E3B8">Â¶</a><code class="hdoc-function-code language-cpp">bool at_eof() const</code></pre></h3><h4>Description</h4><p>Return true if we&apos;ve reached the end of file.</p><p>Declared at: <a class="is-family-code" href="https://github.com/llvm/llvm-project/blob/release/10.x/llvm/include/llvm/ProfileData/SampleProfReader.h#L510">llvm/include/llvm/ProfileData/SampleProfReader.h:510</a></p><h3 id="973ADA4B18473A4A"><pre class="p-0 hdoc-pre-parent"><a class="hdoc-permalink-icon" href="#973ADA4B18473A4A">Â¶</a><code class="hdoc-function-code language-cpp">virtual <a href="https://en.cppreference.com/w/cpp/container/vector">std::vector</a>&lt;StringRef&gt;* getNameTable()</code></pre></h3><h4>Description</h4><p>It includes all the names that have samples either in outline instance or inline instance.</p><p>Declared at: <a class="is-family-code" href="https://github.com/llvm/llvm-project/blob/release/10.x/llvm/include/llvm/ProfileData/SampleProfReader.h#L483">llvm/include/llvm/ProfileData/SampleProfReader.h:483</a></p><h3 id="EADB25CDCADED411"><pre class="p-0 hdoc-pre-parent"><a class="hdoc-permalink-icon" href="#EADB25CDCADED411">Â¶</a><code class="hdoc-function-code language-cpp"><a href="https://en.cppreference.com/w/cpp/error/error_code">std::error_code</a> readFuncProfile(
    const uint8_t* Start)</code></pre></h3><h4>Description</h4><p>Read the next function profile instance.</p><p>Declared at: <a class="is-family-code" href="https://github.com/llvm/llvm-project/blob/release/10.x/llvm/include/llvm/ProfileData/SampleProfReader.h#L513">llvm/include/llvm/ProfileData/SampleProfReader.h:513</a></p><h4>Parameters</h4><dl><dt class="is-family-code">const uint8_t*<b> Start</b></dt></dl><h3 id="066E2C3FC5C24BC3"><pre class="p-0 hdoc-pre-parent"><a class="hdoc-permalink-icon" href="#066E2C3FC5C24BC3">Â¶</a><code class="hdoc-function-code language-cpp">virtual <a href="https://en.cppreference.com/w/cpp/error/error_code">std::error_code</a> readHeader()</code></pre></h3><h4>Description</h4><p>Read and validate the file header.</p><p>Declared at: <a class="is-family-code" href="https://github.com/llvm/llvm-project/blob/release/10.x/llvm/include/llvm/ProfileData/SampleProfReader.h#L476">llvm/include/llvm/ProfileData/SampleProfReader.h:476</a></p><h3 id="87F3BACB9971FC19"><pre class="p-0 hdoc-pre-parent"><a class="hdoc-permalink-icon" href="#87F3BACB9971FC19">Â¶</a><code class="hdoc-function-code language-cpp"><a href="https://en.cppreference.com/w/cpp/error/error_code">std::error_code</a> readImpl()</code></pre></h3><h4>Description</h4><p>Read sample profiles from the associated file.</p><p>Declared at: <a class="is-family-code" href="https://github.com/llvm/llvm-project/blob/release/10.x/llvm/include/llvm/ProfileData/SampleProfReader.h#L479">llvm/include/llvm/ProfileData/SampleProfReader.h:479</a></p><h3 id="BBC7C596D5443EA4"><pre class="p-0 hdoc-pre-parent"><a class="hdoc-permalink-icon" href="#BBC7C596D5443EA4">Â¶</a><code class="hdoc-function-code language-cpp"><a href="https://en.cppreference.com/w/cpp/error/error_code">std::error_code</a> readMagicIdent()</code></pre></h3><h4>Description</h4><p>Read the contents of Magic number and Version number.</p><p>Declared at: <a class="is-family-code" href="https://github.com/llvm/llvm-project/blob/release/10.x/llvm/include/llvm/ProfileData/SampleProfReader.h#L519">llvm/include/llvm/ProfileData/SampleProfReader.h:519</a></p><h3 id="982AB04AE24EE73A"><pre class="p-0 hdoc-pre-parent"><a class="hdoc-permalink-icon" href="#982AB04AE24EE73A">Â¶</a><code class="hdoc-function-code language-cpp">virtual <a href="https://en.cppreference.com/w/cpp/error/error_code">std::error_code</a> readNameTable()</code></pre></h3><h4>Description</h4><p>Read the whole name table.</p><p>Declared at: <a class="is-family-code" href="https://github.com/llvm/llvm-project/blob/release/10.x/llvm/include/llvm/ProfileData/SampleProfReader.h#L525">llvm/include/llvm/ProfileData/SampleProfReader.h:525</a></p><h3 id="E27B8DDF4E268646"><pre class="p-0 hdoc-pre-parent"><a class="hdoc-permalink-icon" href="#E27B8DDF4E268646">Â¶</a><code class="hdoc-function-code language-cpp">template &lt;typename T&gt;
ErrorOr&lt;T&gt; readNumber()</code></pre></h3><h4>Description</h4><p>Read a numeric value of type T from the profile. If an error occurs during decoding, a diagnostic message is emitted and EC is set.</p><p>Declared at: <a class="is-family-code" href="https://github.com/llvm/llvm-project/blob/release/10.x/llvm/include/llvm/ProfileData/SampleProfReader.h#L492">llvm/include/llvm/ProfileData/SampleProfReader.h:492</a></p><h4>Templates</h4><dl><dt class="is-family-code"><b> T</b></dt></dl><h4>Returns</h4><p>the read value.</p><h3 id="4837EC0CF1B49EA4"><pre class="p-0 hdoc-pre-parent"><a class="hdoc-permalink-icon" href="#4837EC0CF1B49EA4">Â¶</a><code class="hdoc-function-code language-cpp"><a href="https://en.cppreference.com/w/cpp/error/error_code">std::error_code</a> readProfile(
    <a href="r6FE30DD77801F96A.html">llvm::sampleprof::FunctionSamples</a>&amp; FProfile)</code></pre></h3><h4>Description</h4><p>Read the contents of the given profile instance.</p><p>Declared at: <a class="is-family-code" href="https://github.com/llvm/llvm-project/blob/release/10.x/llvm/include/llvm/ProfileData/SampleProfReader.h#L516">llvm/include/llvm/ProfileData/SampleProfReader.h:516</a></p><h4>Parameters</h4><dl><dt class="is-family-code"><a href="r6FE30DD77801F96A.html">llvm::sampleprof::FunctionSamples</a>&amp;<b> FProfile</b></dt></dl><h3 id="C1BC3BEC28C03F06"><pre class="p-0 hdoc-pre-parent"><a class="hdoc-permalink-icon" href="#C1BC3BEC28C03F06">Â¶</a><code class="hdoc-function-code language-cpp"><a href="rD60C34ED5A112927.html">ErrorOr</a>&lt;llvm::StringRef&gt; readString()</code></pre></h3><h4>Description</h4><p>Read a string from the profile. If an error occurs during decoding, a diagnostic message is emitted and EC is set.</p><p>Declared at: <a class="is-family-code" href="https://github.com/llvm/llvm-project/blob/release/10.x/llvm/include/llvm/ProfileData/SampleProfReader.h#L504">llvm/include/llvm/ProfileData/SampleProfReader.h:504</a></p><h4>Returns</h4><p>the read value.</p><h3 id="4CEE879EA321ECDA"><pre class="p-0 hdoc-pre-parent"><a class="hdoc-permalink-icon" href="#4CEE879EA321ECDA">Â¶</a><code class="hdoc-function-code language-cpp">virtual <a href="rD60C34ED5A112927.html">ErrorOr</a>&lt;llvm::StringRef&gt;
readStringFromTable()</code></pre></h3><h4>Description</h4><p>Read a string indirectly via the name table.</p><p>Declared at: <a class="is-family-code" href="https://github.com/llvm/llvm-project/blob/release/10.x/llvm/include/llvm/ProfileData/SampleProfReader.h#L537">llvm/include/llvm/ProfileData/SampleProfReader.h:537</a></p><h3 id="F710D9F1A0510637"><pre class="p-0 hdoc-pre-parent"><a class="hdoc-permalink-icon" href="#F710D9F1A0510637">Â¶</a><code class="hdoc-function-code language-cpp">template &lt;typename T&gt;
inline <a href="rD60C34ED5A112927.html">ErrorOr</a>&lt;uint32_t&gt; readStringIndex(T&amp; Table)</code></pre></h3><h4>Description</h4><p>Read the string index and check whether it overflows the table.</p><p>Declared at: <a class="is-family-code" href="https://github.com/llvm/llvm-project/blob/release/10.x/llvm/include/llvm/ProfileData/SampleProfReader.h#L507">llvm/include/llvm/ProfileData/SampleProfReader.h:507</a></p><h4>Templates</h4><dl><dt class="is-family-code"><b> T</b></dt></dl><h4>Parameters</h4><dl><dt class="is-family-code">T&amp;<b> Table</b></dt></dl><h3 id="9214B46A860DE566"><pre class="p-0 hdoc-pre-parent"><a class="hdoc-permalink-icon" href="#9214B46A860DE566">Â¶</a><code class="hdoc-function-code language-cpp"><a href="https://en.cppreference.com/w/cpp/error/error_code">std::error_code</a> readSummary()</code></pre></h3><h4>Description</h4><p>Read profile summary.</p><p>Declared at: <a class="is-family-code" href="https://github.com/llvm/llvm-project/blob/release/10.x/llvm/include/llvm/ProfileData/SampleProfReader.h#L522">llvm/include/llvm/ProfileData/SampleProfReader.h:522</a></p><h3 id="0E2E70F3E29A6455"><pre class="p-0 hdoc-pre-parent"><a class="hdoc-permalink-icon" href="#0E2E70F3E29A6455">Â¶</a><code class="hdoc-function-code language-cpp">template &lt;typename T&gt;
ErrorOr&lt;T&gt; readUnencodedNumber()</code></pre></h3><h4>Description</h4><p>Read a numeric value of type T from the profile. The value is saved without encoded.</p><p>Declared at: <a class="is-family-code" href="https://github.com/llvm/llvm-project/blob/release/10.x/llvm/include/llvm/ProfileData/SampleProfReader.h#L496">llvm/include/llvm/ProfileData/SampleProfReader.h:496</a></p><h4>Templates</h4><dl><dt class="is-family-code"><b> T</b></dt></dl></main></div></div></div></section></div><footer class="footer"><p>Documentation for LLVM 10.0.0.</p><p>Generated by <a href="https://hdoc.io/">hdoc</a> version 1.4.0-hdocInternal on 2022-12-14T09:44:14 UTC.</p><p class="has-text-grey-light">19AD43E11B2996</p></footer></body></html>