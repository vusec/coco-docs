<!DOCTYPE html><html><head><meta charset="utf-8"></meta><meta content="width=device-width, initial-scale=1" name="viewport"></meta><title>class MemoryDepChecker: LLVM 10.0.0 documentation</title><link href="styles.css" rel="stylesheet"></link><script src="highlight.min.js"></script><script>hljs.highlightAll();</script><link href="katex.min.css" rel="stylesheet"></link><script src="katex.min.js"></script><script src="auto-render.min.js"></script><script>
    document.addEventListener("DOMContentLoaded", function() {
      renderMathInElement(document.body, {
        delimiters: [
          {left: '$$', right: '$$', display: true},
          {left: '$', right: '$', display: false},
        ],
      });
    });
  </script><link href="apple-touch-icon.png" sizes="180x180" rel="apple-touch-icon"></link><link href="favicon-32x32.png" sizes="32x32" type="image/png" rel="icon"></link><link href="favicon-16x16.png" sizes="16x16" type="image/png" rel="icon"></link></head><body><div id="wrapper"><section class="section"><div class="container"><div class="columns"><aside class="column is-one-fifth"><ul class="menu-list"><p class="is-size-4">LLVM 10.0.0</p><p class="menu-label">Navigation</p><li><a href="index.html">Home</a></li><li><a href="search.html">Search</a></li><li><a href="https://github.com/llvm/llvm-project/">Repository</a></li><li><a href="https://hdoc.io">Made with hdoc</a></li><p class="menu-label">API Documentation</p><li><a href="functions.html">Functions</a></li><li><a href="records.html">Records</a></li><li><a href="enums.html">Enums</a></li><li><a href="namespaces.html">Namespaces</a></li></ul></aside><div class="column" style="overflow-x: auto"><nav class="breadcrumb has-arrow-separator" aria-label="breadcrumbs"><ul><li><a href="namespaces.html#00A4DA910CC17C2D"><span>namespace llvm</span></a></li><li class="is-active"><a aria-current="pageC32F7FA384B8883D"><span>class MemoryDepChecker</span></a></li></ul></nav><main class="content"><h1>class MemoryDepChecker</h1><h2>Declaration</h2><pre class="p-0"><code class="hdoc-record-code language-cpp">class MemoryDepChecker { /* full declaration omitted */ };</code></pre><h2>Description</h2><p>Checks memory dependences among accesses to the same underlying object to determine whether there vectorization is legal or not (and at which vectorization factor). Note: This class will compute a conservative dependence for access to different underlying pointers. Clients, such as the loop vectorizer, will sometimes deal these potential dependencies by emitting runtime checks. We use the ScalarEvolution framework to symbolically evalutate access functions pairs. Since we currently don&apos;t restructure the loop we can rely on the program order of memory accesses to determine their safety. At the moment we will only deem accesses as safe for: * A negative constant distance assuming program order. Safe: tmp = a[i + 1];     OR     a[i + 1] = x; a[i] = tmp;                y = a[i]; The latter case is safe because later checks guarantuee that there can&apos;t be a cycle through a phi node (that is, we check that &quot;x&quot; and &quot;y&quot; is not the same variable: a header phi can only be an induction or a reduction, a reduction can&apos;t have a memory sink, an induction can&apos;t have a memory source). This is important and must not be violated (or we have to resort to checking for cycles through memory). * A positive constant distance assuming program order that is bigger than the biggest memory access. tmp = a[i]        OR              b[i] = x a[i+2] = tmp                      y = b[i+2]; Safe distance: 2 x sizeof(a[0]), and 2 x sizeof(b[0]), respectively. * Zero distances and all accesses have the same size.</p><p>Declared at: <a class="is-family-code" href="https://github.com/llvm/llvm-project/blob/release/10.x/llvm/include/llvm/Analysis/LoopAccessAnalysis.h#L92">llvm/include/llvm/Analysis/LoopAccessAnalysis.h:92</a></p><h2>Method Overview</h2><ul><li class="is-family-code">public  <a href="#1F4FB6681369792E"><b>MemoryDepChecker</b></a>(llvm::PredicatedScalarEvolution &amp; PSE, const llvm::Loop * L)</li><li class="is-family-code">public void  <a href="#56B9B6530E567ACA"><b>addAccess</b></a>(llvm::StoreInst * SI)</li><li class="is-family-code">public void  <a href="#464A27F36743D4CD"><b>addAccess</b></a>(llvm::LoadInst * LI)</li><li class="is-family-code">public bool  <a href="#D91E92D1EA469D84"><b>areDepsSafe</b></a>(llvm::MemoryDepChecker::DepCandidates &amp; AccessSets, llvm::MemoryDepChecker::MemAccessInfoList &amp; CheckDeps, const llvm::ValueToValueMap &amp; Strides)</li><li class="is-family-code">public void  <a href="#E495D3967AB3927A"><b>clearDependences</b></a>()</li><li class="is-family-code">public DenseMap&lt;llvm::Instruction *, unsigned int&gt;  <a href="#0D745BDBC84B380A"><b>generateInstructionOrderMap</b></a>() const</li><li class="is-family-code">public const SmallVectorImpl&lt;llvm::MemoryDepChecker::Dependence&gt; *  <a href="#FE5189F48A92D865"><b>getDependences</b></a>() const</li><li class="is-family-code">public SmallVector&lt;llvm::Instruction *, 4&gt;  <a href="#3474CD3B8B8DC71E"><b>getInstructionsForAccess</b></a>(llvm::Value * Ptr, bool isWrite) const</li><li class="is-family-code">public uint64_t  <a href="#0531BA4663FC259D"><b>getMaxSafeDepDistBytes</b></a>()</li><li class="is-family-code">public uint64_t  <a href="#96E36FBE487DA7B6"><b>getMaxSafeRegisterWidth</b></a>() const</li><li class="is-family-code">public const SmallVectorImpl&lt;llvm::Instruction *&gt; &amp;  <a href="#4B8384A177457169"><b>getMemoryInstructions</b></a>() const</li><li class="is-family-code">public bool  <a href="#F1C7C9C1B10436AA"><b>isSafeForVectorization</b></a>() const</li><li class="is-family-code">public bool  <a href="#CA37A66545F7F378"><b>shouldRetryWithRuntimeCheck</b></a>() const</li></ul><h2>Methods</h2><h3 id="1F4FB6681369792E"><pre class="p-0 hdoc-pre-parent"><a class="hdoc-permalink-icon" href="#1F4FB6681369792E">¶</a><code class="hdoc-function-code language-cpp">MemoryDepChecker(
    <a href="rB18B275B6D5D599D.html">llvm::PredicatedScalarEvolution</a>&amp; PSE,
    const <a href="r210AF08D1E341AC3.html">llvm::Loop</a>* L)</code></pre></h3><p>Declared at: <a class="is-family-code" href="https://github.com/llvm/llvm-project/blob/release/10.x/llvm/include/llvm/Analysis/LoopAccessAnalysis.h#L177">llvm/include/llvm/Analysis/LoopAccessAnalysis.h:177</a></p><h4>Parameters</h4><dl><dt class="is-family-code"><a href="rB18B275B6D5D599D.html">llvm::PredicatedScalarEvolution</a>&amp;<b> PSE</b></dt><dt class="is-family-code">const <a href="r210AF08D1E341AC3.html">llvm::Loop</a>*<b> L</b></dt></dl><h3 id="56B9B6530E567ACA"><pre class="p-0 hdoc-pre-parent"><a class="hdoc-permalink-icon" href="#56B9B6530E567ACA">¶</a><code class="hdoc-function-code language-cpp">void addAccess(<a href="r9139824E2B7B4B8F.html">llvm::StoreInst</a>* SI)</code></pre></h3><h4>Description</h4><p>Register the location (instructions are given increasing numbers) of a write access.</p><p>Declared at: <a class="is-family-code" href="https://github.com/llvm/llvm-project/blob/release/10.x/llvm/include/llvm/Analysis/LoopAccessAnalysis.h#L184">llvm/include/llvm/Analysis/LoopAccessAnalysis.h:184</a></p><h4>Parameters</h4><dl><dt class="is-family-code"><a href="r9139824E2B7B4B8F.html">llvm::StoreInst</a>*<b> SI</b></dt></dl><h3 id="464A27F36743D4CD"><pre class="p-0 hdoc-pre-parent"><a class="hdoc-permalink-icon" href="#464A27F36743D4CD">¶</a><code class="hdoc-function-code language-cpp">void addAccess(<a href="r537857E9FE6D2795.html">llvm::LoadInst</a>* LI)</code></pre></h3><h4>Description</h4><p>Register the location (instructions are given increasing numbers) of a write access.</p><p>Declared at: <a class="is-family-code" href="https://github.com/llvm/llvm-project/blob/release/10.x/llvm/include/llvm/Analysis/LoopAccessAnalysis.h#L193">llvm/include/llvm/Analysis/LoopAccessAnalysis.h:193</a></p><h4>Parameters</h4><dl><dt class="is-family-code"><a href="r537857E9FE6D2795.html">llvm::LoadInst</a>*<b> LI</b></dt></dl><h3 id="D91E92D1EA469D84"><pre class="p-0 hdoc-pre-parent"><a class="hdoc-permalink-icon" href="#D91E92D1EA469D84">¶</a><code class="hdoc-function-code language-cpp">bool areDepsSafe(
    <a href="rD8C80D0C29B9C295.html">llvm::MemoryDepChecker::DepCandidates</a>&amp;
        AccessSets,
    <a href="r62CD0592E97953B6.html">llvm::MemoryDepChecker::MemAccessInfoList</a>&amp;
        CheckDeps,
    const <a href="rC2880C7E8E458B54.html">llvm::ValueToValueMap</a>&amp; Strides)</code></pre></h3><h4>Description</h4><p>Check whether the dependencies between the accesses are safe. Only checks sets with elements in \p CheckDeps.</p><p>Declared at: <a class="is-family-code" href="https://github.com/llvm/llvm-project/blob/release/10.x/llvm/include/llvm/Analysis/LoopAccessAnalysis.h#L203">llvm/include/llvm/Analysis/LoopAccessAnalysis.h:203</a></p><h4>Parameters</h4><dl><dt class="is-family-code"><a href="rD8C80D0C29B9C295.html">llvm::MemoryDepChecker::DepCandidates</a>&amp;<b> AccessSets</b></dt><dt class="is-family-code"><a href="r62CD0592E97953B6.html">llvm::MemoryDepChecker::MemAccessInfoList</a>&amp;<b> CheckDeps</b></dt><dt class="is-family-code">const <a href="rC2880C7E8E458B54.html">llvm::ValueToValueMap</a>&amp;<b> Strides</b></dt></dl><h3 id="E495D3967AB3927A"><pre class="p-0 hdoc-pre-parent"><a class="hdoc-permalink-icon" href="#E495D3967AB3927A">¶</a><code class="hdoc-function-code language-cpp">void clearDependences()</code></pre></h3><p>Declared at: <a class="is-family-code" href="https://github.com/llvm/llvm-project/blob/release/10.x/llvm/include/llvm/Analysis/LoopAccessAnalysis.h#L234">llvm/include/llvm/Analysis/LoopAccessAnalysis.h:234</a></p><h3 id="0D745BDBC84B380A"><pre class="p-0 hdoc-pre-parent"><a class="hdoc-permalink-icon" href="#0D745BDBC84B380A">¶</a><code class="hdoc-function-code language-cpp"><a href="rC2880C7E8E458B54.html">DenseMap</a>&lt;llvm::Instruction*, unsigned int&gt;
generateInstructionOrderMap() const</code></pre></h3><h4>Description</h4><p>Generate a mapping between the memory instructions and their indices according to program order.</p><p>Declared at: <a class="is-family-code" href="https://github.com/llvm/llvm-project/blob/release/10.x/llvm/include/llvm/Analysis/LoopAccessAnalysis.h#L244">llvm/include/llvm/Analysis/LoopAccessAnalysis.h:244</a></p><h3 id="FE5189F48A92D865"><pre class="p-0 hdoc-pre-parent"><a class="hdoc-permalink-icon" href="#FE5189F48A92D865">¶</a><code class="hdoc-function-code language-cpp">const <a href="r6CBD92E95A65634C.html">SmallVectorImpl</a>&lt;
    llvm::MemoryDepChecker::Dependence&gt;*
getDependences() const</code></pre></h3><h4>Description</h4><p>Returns the memory dependences.  If null is returned we exceeded the MaxDependences threshold and this information is not available.</p><p>Declared at: <a class="is-family-code" href="https://github.com/llvm/llvm-project/blob/release/10.x/llvm/include/llvm/Analysis/LoopAccessAnalysis.h#L230">llvm/include/llvm/Analysis/LoopAccessAnalysis.h:230</a></p><h3 id="3474CD3B8B8DC71E"><pre class="p-0 hdoc-pre-parent"><a class="hdoc-permalink-icon" href="#3474CD3B8B8DC71E">¶</a><code class="hdoc-function-code language-cpp"><a href="r62CD0592E97953B6.html">SmallVector</a>&lt;llvm::Instruction*, 4&gt;
getInstructionsForAccess(<a href="r4EC65655F3BC4E59.html">llvm::Value</a>* Ptr,
                         bool isWrite) const</code></pre></h3><h4>Description</h4><p>Find the set of instructions that read or write via \p Ptr.</p><p>Declared at: <a class="is-family-code" href="https://github.com/llvm/llvm-project/blob/release/10.x/llvm/include/llvm/Analysis/LoopAccessAnalysis.h#L254">llvm/include/llvm/Analysis/LoopAccessAnalysis.h:254</a></p><h4>Parameters</h4><dl><dt class="is-family-code"><a href="r4EC65655F3BC4E59.html">llvm::Value</a>*<b> Ptr</b></dt><dt class="is-family-code">bool<b> isWrite</b></dt></dl><h3 id="0531BA4663FC259D"><pre class="p-0 hdoc-pre-parent"><a class="hdoc-permalink-icon" href="#0531BA4663FC259D">¶</a><code class="hdoc-function-code language-cpp">uint64_t getMaxSafeDepDistBytes()</code></pre></h3><h4>Description</h4><p>The maximum number of bytes of a vector register we can vectorize the accesses safely with.</p><p>Declared at: <a class="is-family-code" href="https://github.com/llvm/llvm-project/blob/release/10.x/llvm/include/llvm/Analysis/LoopAccessAnalysis.h#L214">llvm/include/llvm/Analysis/LoopAccessAnalysis.h:214</a></p><h3 id="96E36FBE487DA7B6"><pre class="p-0 hdoc-pre-parent"><a class="hdoc-permalink-icon" href="#96E36FBE487DA7B6">¶</a><code class="hdoc-function-code language-cpp">uint64_t getMaxSafeRegisterWidth() const</code></pre></h3><h4>Description</h4><p>Return the number of elements that are safe to operate on simultaneously, multiplied by the size of the element in bits.</p><p>Declared at: <a class="is-family-code" href="https://github.com/llvm/llvm-project/blob/release/10.x/llvm/include/llvm/Analysis/LoopAccessAnalysis.h#L218">llvm/include/llvm/Analysis/LoopAccessAnalysis.h:218</a></p><h3 id="4B8384A177457169"><pre class="p-0 hdoc-pre-parent"><a class="hdoc-permalink-icon" href="#4B8384A177457169">¶</a><code class="hdoc-function-code language-cpp">const <a href="r6CBD92E95A65634C.html">SmallVectorImpl</a>&lt;llvm::Instruction*&gt;&amp;
getMemoryInstructions() const</code></pre></h3><h4>Description</h4><p>The vector of memory access instructions.  The indices are used as instruction identifiers in the Dependence class.</p><p>Declared at: <a class="is-family-code" href="https://github.com/llvm/llvm-project/blob/release/10.x/llvm/include/llvm/Analysis/LoopAccessAnalysis.h#L238">llvm/include/llvm/Analysis/LoopAccessAnalysis.h:238</a></p><h3 id="F1C7C9C1B10436AA"><pre class="p-0 hdoc-pre-parent"><a class="hdoc-permalink-icon" href="#F1C7C9C1B10436AA">¶</a><code class="hdoc-function-code language-cpp">bool isSafeForVectorization() const</code></pre></h3><h4>Description</h4><p>No memory dependence was encountered that would inhibit vectorization.</p><p>Declared at: <a class="is-family-code" href="https://github.com/llvm/llvm-project/blob/release/10.x/llvm/include/llvm/Analysis/LoopAccessAnalysis.h#L208">llvm/include/llvm/Analysis/LoopAccessAnalysis.h:208</a></p><h3 id="CA37A66545F7F378"><pre class="p-0 hdoc-pre-parent"><a class="hdoc-permalink-icon" href="#CA37A66545F7F378">¶</a><code class="hdoc-function-code language-cpp">bool shouldRetryWithRuntimeCheck() const</code></pre></h3><h4>Description</h4><p>In same cases when the dependency check fails we can still vectorize the loop with a dynamic array access check.</p><p>Declared at: <a class="is-family-code" href="https://github.com/llvm/llvm-project/blob/release/10.x/llvm/include/llvm/Analysis/LoopAccessAnalysis.h#L222">llvm/include/llvm/Analysis/LoopAccessAnalysis.h:222</a></p></main></div></div></div></section></div><footer class="footer"><p>Documentation for LLVM 10.0.0.</p><p>Generated by <a href="https://hdoc.io/">hdoc</a> version 1.4.0-hdocInternal on 2022-12-14T09:44:14 UTC.</p><p class="has-text-grey-light">19AD43E11B2996</p></footer></body></html>