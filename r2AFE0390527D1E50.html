<!DOCTYPE html><html><head><meta charset="utf-8"></meta><meta content="width=device-width, initial-scale=1" name="viewport"></meta><title>class StratifiedSetsBuilder: LLVM 10.0.0 documentation</title><link href="styles.css" rel="stylesheet"></link><script src="highlight.min.js"></script><script>hljs.highlightAll();</script><link href="katex.min.css" rel="stylesheet"></link><script src="katex.min.js"></script><script src="auto-render.min.js"></script><script>
    document.addEventListener("DOMContentLoaded", function() {
      renderMathInElement(document.body, {
        delimiters: [
          {left: '$$', right: '$$', display: true},
          {left: '$', right: '$', display: false},
        ],
      });
    });
  </script><link href="apple-touch-icon.png" sizes="180x180" rel="apple-touch-icon"></link><link href="favicon-32x32.png" sizes="32x32" type="image/png" rel="icon"></link><link href="favicon-16x16.png" sizes="16x16" type="image/png" rel="icon"></link></head><body><div id="wrapper"><section class="section"><div class="container"><div class="columns"><aside class="column is-one-fifth"><ul class="menu-list"><p class="is-size-4">LLVM 10.0.0</p><p class="menu-label">Navigation</p><li><a href="index.html">Home</a></li><li><a href="search.html">Search</a></li><li><a href="https://github.com/llvm/llvm-project/">Repository</a></li><li><a href="https://hdoc.io">Made with hdoc</a></li><p class="menu-label">API Documentation</p><li><a href="functions.html">Functions</a></li><li><a href="records.html">Records</a></li><li><a href="enums.html">Enums</a></li><li><a href="namespaces.html">Namespaces</a></li></ul></aside><div class="column" style="overflow-x: auto"><nav class="breadcrumb has-arrow-separator" aria-label="breadcrumbs"><ul><li><a href="namespaces.html#00A4DA910CC17C2D"><span>namespace llvm</span></a></li><li><a href="namespaces.html#EAFD19AD92897EF7"><span>namespace cflaa</span></a></li><li class="is-active"><a aria-current="page2AFE0390527D1E50"><span>class StratifiedSetsBuilder</span></a></li></ul></nav><main class="content"><h1>class StratifiedSetsBuilder</h1><h2>Declaration</h2><pre class="p-0"><code class="hdoc-record-code language-cpp">template &lt;typename T&gt;
class StratifiedSetsBuilder { /* full declaration omitted */ };</code></pre><h2>Description</h2><p>Generic Builder class that produces StratifiedSets instances. The goal of this builder is to efficiently produce correct StratifiedSets instances. To this end, we use a few tricks: &gt; Set chains (A method for linking sets together) &gt; Set remaps (A method for marking a set as an alias [irony?] of another) ==== Set chains ==== This builder has a notion of some value A being above, below, or with some other value B: &gt; The `A above B` relationship implies that there is a reference edge going from A to B. Namely, it notes that A can store anything in B&apos;s set. &gt; The `A below B` relationship is the opposite of `A above B`. It implies that there&apos;s a dereference edge going from A to B. &gt; The `A with B` relationship states that there&apos;s an assignment edge going from A to B, and that A and B should be treated as equals. As an example, take the following code snippet: %a = alloca i32, align 4 %ap = alloca i32*, align 8 %app = alloca i32**, align 8 store %a, %ap store %ap, %app %aw = getelementptr %ap, i32 0 Given this, the following relations exist: - %a below %ap  &amp; %ap above %a - %ap below %app  &amp; %app above %ap - %aw with %ap  &amp; %ap with %aw These relations produce the following sets: [{%a}, {%ap, %aw}, {%app}] ...Which state that the only MayAlias relationship in the above program is between %ap and %aw. Because LLVM allows arbitrary casts, code like the following needs to be supported: %ip = alloca i64, align 8 %ipp = alloca i64*, align 8 %i = bitcast i64** ipp to i64 store i64* %ip, i64** %ipp store i64 %i, i64* %ip Which, because %ipp ends up *both* above and below %ip, is fun. This is solved by merging %i and %ipp into a single set (...which is the only way to solve this, since their bit patterns are equivalent). Any sets that ended up in between %i and %ipp at the time of merging (in this case, the set containing %ip) also get conservatively merged into the set of %i and %ipp. In short, the resulting StratifiedSet from the above code would be {%ip, %ipp, %i}. ==== Set remaps ==== More of an implementation detail than anything -- when merging sets, we need to update the numbers of all of the elements mapped to those sets. Rather than doing this at each merge, we note in the BuilderLink structure that a remap has occurred, and use this information so we can defer renumbering set elements until build time.</p><p>Declared at: <a class="is-family-code" href="https://github.com/llvm/llvm-project/blob/release/10.x/llvm/lib/Analysis/StratifiedSets.h#L173">llvm/lib/Analysis/StratifiedSets.h:173</a></p><h2>Templates</h2><dl><dt class="is-family-code"><b> T</b></dt></dl><h2>Method Overview</h2><ul><li class="is-family-code">public bool  <a href="#B59A07FFAE93E4C6"><b>add</b></a>(const T &amp; Main)</li><li class="is-family-code">public bool  <a href="#8E77CA1DC12BFFF3"><b>addAbove</b></a>(const T &amp; Main, const T &amp; ToAdd)</li><li class="is-family-code">public bool  <a href="#0503F15E686975B3"><b>addBelow</b></a>(const T &amp; Main, const T &amp; ToAdd)</li><li class="is-family-code">public bool  <a href="#05C097530AE1F404"><b>addWith</b></a>(const T &amp; Main, const T &amp; ToAdd)</li><li class="is-family-code">public StratifiedSets&lt;T&gt;  <a href="#844435CECD0DFD7D"><b>build</b></a>()</li><li class="is-family-code">public bool  <a href="#B8931E18B961DD4A"><b>has</b></a>(const T &amp; Elem) const</li><li class="is-family-code">public void  <a href="#7430234C49D63024"><b>noteAttributes</b></a>(const T &amp; Main, llvm::cflaa::AliasAttrs NewAttrs)</li></ul><h2>Methods</h2><h3 id="B59A07FFAE93E4C6"><pre class="p-0 hdoc-pre-parent"><a class="hdoc-permalink-icon" href="#B59A07FFAE93E4C6">¶</a><code class="hdoc-function-code language-cpp">bool add(const T&amp; Main)</code></pre></h3><p>Declared at: <a class="is-family-code" href="https://github.com/llvm/llvm-project/blob/release/10.x/llvm/lib/Analysis/StratifiedSets.h#L345">llvm/lib/Analysis/StratifiedSets.h:345</a></p><h4>Parameters</h4><dl><dt class="is-family-code">const T&amp;<b> Main</b></dt></dl><h3 id="8E77CA1DC12BFFF3"><pre class="p-0 hdoc-pre-parent"><a class="hdoc-permalink-icon" href="#8E77CA1DC12BFFF3">¶</a><code class="hdoc-function-code language-cpp">bool addAbove(const T&amp; Main, const T&amp; ToAdd)</code></pre></h3><h4>Description</h4><p>Restructures the stratified sets as necessary to make &quot;ToAdd&quot; in a set above &quot;Main&quot;. There are some cases where this is not possible (see above), so we merge them such that ToAdd and Main are in the same set.</p><p>Declared at: <a class="is-family-code" href="https://github.com/llvm/llvm-project/blob/release/10.x/llvm/lib/Analysis/StratifiedSets.h#L356">llvm/lib/Analysis/StratifiedSets.h:356</a></p><h4>Parameters</h4><dl><dt class="is-family-code">const T&amp;<b> Main</b></dt><dt class="is-family-code">const T&amp;<b> ToAdd</b></dt></dl><h3 id="0503F15E686975B3"><pre class="p-0 hdoc-pre-parent"><a class="hdoc-permalink-icon" href="#0503F15E686975B3">¶</a><code class="hdoc-function-code language-cpp">bool addBelow(const T&amp; Main, const T&amp; ToAdd)</code></pre></h3><h4>Description</h4><p>Restructures the stratified sets as necessary to make &quot;ToAdd&quot; in a set below &quot;Main&quot;. There are some cases where this is not possible (see above), so we merge them such that ToAdd and Main are in the same set.</p><p>Declared at: <a class="is-family-code" href="https://github.com/llvm/llvm-project/blob/release/10.x/llvm/lib/Analysis/StratifiedSets.h#L369">llvm/lib/Analysis/StratifiedSets.h:369</a></p><h4>Parameters</h4><dl><dt class="is-family-code">const T&amp;<b> Main</b></dt><dt class="is-family-code">const T&amp;<b> ToAdd</b></dt></dl><h3 id="05C097530AE1F404"><pre class="p-0 hdoc-pre-parent"><a class="hdoc-permalink-icon" href="#05C097530AE1F404">¶</a><code class="hdoc-function-code language-cpp">bool addWith(const T&amp; Main, const T&amp; ToAdd)</code></pre></h3><p>Declared at: <a class="is-family-code" href="https://github.com/llvm/llvm-project/blob/release/10.x/llvm/lib/Analysis/StratifiedSets.h#L379">llvm/lib/Analysis/StratifiedSets.h:379</a></p><h4>Parameters</h4><dl><dt class="is-family-code">const T&amp;<b> Main</b></dt><dt class="is-family-code">const T&amp;<b> ToAdd</b></dt></dl><h3 id="844435CECD0DFD7D"><pre class="p-0 hdoc-pre-parent"><a class="hdoc-permalink-icon" href="#844435CECD0DFD7D">¶</a><code class="hdoc-function-code language-cpp">StratifiedSets&lt;T&gt; build()</code></pre></h3><h4>Description</h4><p>Builds a StratifiedSet from the information we&apos;ve been given since either construction or the prior build() call.</p><p>Declared at: <a class="is-family-code" href="https://github.com/llvm/llvm-project/blob/release/10.x/llvm/lib/Analysis/StratifiedSets.h#L335">llvm/lib/Analysis/StratifiedSets.h:335</a></p><h3 id="B8931E18B961DD4A"><pre class="p-0 hdoc-pre-parent"><a class="hdoc-permalink-icon" href="#B8931E18B961DD4A">¶</a><code class="hdoc-function-code language-cpp">bool has(const T&amp; Elem) const</code></pre></h3><p>Declared at: <a class="is-family-code" href="https://github.com/llvm/llvm-project/blob/release/10.x/llvm/lib/Analysis/StratifiedSets.h#L343">llvm/lib/Analysis/StratifiedSets.h:343</a></p><h4>Parameters</h4><dl><dt class="is-family-code">const T&amp;<b> Elem</b></dt></dl><h3 id="7430234C49D63024"><pre class="p-0 hdoc-pre-parent"><a class="hdoc-permalink-icon" href="#7430234C49D63024">¶</a><code class="hdoc-function-code language-cpp">void noteAttributes(
    const T&amp; Main,
    llvm::cflaa::AliasAttrs NewAttrs)</code></pre></h3><p>Declared at: <a class="is-family-code" href="https://github.com/llvm/llvm-project/blob/release/10.x/llvm/lib/Analysis/StratifiedSets.h#L385">llvm/lib/Analysis/StratifiedSets.h:385</a></p><h4>Parameters</h4><dl><dt class="is-family-code">const T&amp;<b> Main</b></dt><dt class="is-family-code">llvm::cflaa::AliasAttrs<b> NewAttrs</b></dt></dl></main></div></div></div></section></div><footer class="footer"><p>Documentation for LLVM 10.0.0.</p><p>Generated by <a href="https://hdoc.io/">hdoc</a> version 1.4.0-hdocInternal on 2022-12-14T09:44:14 UTC.</p><p class="has-text-grey-light">19AD43E11B2996</p></footer></body></html>