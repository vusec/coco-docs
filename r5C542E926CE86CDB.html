<!DOCTYPE html><html><head><meta charset="utf-8"></meta><meta content="width=device-width, initial-scale=1" name="viewport"></meta><title>struct ByteArrayBuilder: LLVM 10.0.0 documentation</title><link href="styles.css" rel="stylesheet"></link><script src="highlight.min.js"></script><script>hljs.highlightAll();</script><link href="katex.min.css" rel="stylesheet"></link><script src="katex.min.js"></script><script src="auto-render.min.js"></script><script>
    document.addEventListener("DOMContentLoaded", function() {
      renderMathInElement(document.body, {
        delimiters: [
          {left: '$$', right: '$$', display: true},
          {left: '$', right: '$', display: false},
        ],
      });
    });
  </script><link href="apple-touch-icon.png" sizes="180x180" rel="apple-touch-icon"></link><link href="favicon-32x32.png" sizes="32x32" type="image/png" rel="icon"></link><link href="favicon-16x16.png" sizes="16x16" type="image/png" rel="icon"></link></head><body><div id="wrapper"><section class="section"><div class="container"><div class="columns"><aside class="column is-one-fifth"><ul class="menu-list"><p class="is-size-4">LLVM 10.0.0</p><p class="menu-label">Navigation</p><li><a href="index.html">Home</a></li><li><a href="search.html">Search</a></li><li><a href="https://github.com/llvm/llvm-project/">Repository</a></li><li><a href="https://hdoc.io">Made with hdoc</a></li><p class="menu-label">API Documentation</p><li><a href="functions.html">Functions</a></li><li><a href="records.html">Records</a></li><li><a href="enums.html">Enums</a></li><li><a href="namespaces.html">Namespaces</a></li></ul></aside><div class="column" style="overflow-x: auto"><nav class="breadcrumb has-arrow-separator" aria-label="breadcrumbs"><ul><li><a href="namespaces.html#00A4DA910CC17C2D"><span>namespace llvm</span></a></li><li><a href="namespaces.html#488C7851E8DF27D3"><span>namespace lowertypetests</span></a></li><li class="is-active"><a aria-current="page5C542E926CE86CDB"><span>struct ByteArrayBuilder</span></a></li></ul></nav><main class="content"><h1>struct ByteArrayBuilder</h1><h2>Declaration</h2><pre class="p-0"><code class="hdoc-record-code language-cpp">struct ByteArrayBuilder { /* full declaration omitted */ };</code></pre><h2>Description</h2><p>This class is used to build a byte array containing overlapping bit sets. By loading from indexed offsets into the byte array and applying a mask, a program can test bits from the bit set with a relatively short instruction sequence. For example, suppose we have 15 bit sets to lay out: A (16 bits), B (15 bits), C (14 bits), D (13 bits), E (12 bits), F (11 bits), G (10 bits), H (9 bits), I (7 bits), J (6 bits), K (5 bits), L (4 bits), M (3 bits), N (2 bits), O (1 bit) These bits can be laid out in a 16-byte array like this: Byte Offset 0123456789ABCDEF Bit 7 HHHHHHHHHIIIIIII 6 GGGGGGGGGGJJJJJJ 5 FFFFFFFFFFFKKKKK 4 EEEEEEEEEEEELLLL 3 DDDDDDDDDDDDDMMM 2 CCCCCCCCCCCCCCNN 1 BBBBBBBBBBBBBBBO 0 AAAAAAAAAAAAAAAA For example, to test bit X of A, we evaluate ((bits[X]  &amp; 1) != 0), or to test bit X of I, we evaluate ((bits[9 + X]  &amp; 0x80) != 0). This can be done in 1-2 machine instructions on x86, or 4-6 instructions on ARM. This is a byte array, rather than (say) a 2-byte array or a 4-byte array, because for one thing it gives us better packing (the more bins there are, the less evenly they will be filled), and for another, the instruction sequences can be slightly shorter, both on x86 and ARM.</p><p>Declared at: <a class="is-family-code" href="https://github.com/llvm/llvm-project/blob/release/10.x/llvm/include/llvm/Transforms/IPO/LowerTypeTests.h#L174">llvm/include/llvm/Transforms/IPO/LowerTypeTests.h:174</a></p><h2>Member Variables</h2><dl><dt class="is-family-code" id="var_Bytes">public  <a href="https://en.cppreference.com/w/cpp/container/vector">std::vector</a>&lt;uint8_t&gt; <b>Bytes</b></dt><dd>The byte array built so far.</dd><dt class="is-family-code" id="var_BitAllocs">public  uint64_t[8] <b>BitAllocs</b></dt><dd>The number of bytes allocated so far for each of the bits.</dd></dl><h2>Method Overview</h2><ul><li class="is-family-code">public  <a href="#EC91A7B7311DA39A"><b>ByteArrayBuilder</b></a>()</li><li class="is-family-code">public void  <a href="#F1140C93418424D0"><b>allocate</b></a>(const std::set&lt;uint64_t&gt; &amp; Bits, uint64_t BitSize, uint64_t &amp; AllocByteOffset, uint8_t &amp; AllocMask)</li></ul><h2>Methods</h2><h3 id="EC91A7B7311DA39A"><pre class="p-0 hdoc-pre-parent"><a class="hdoc-permalink-icon" href="#EC91A7B7311DA39A">¶</a><code class="hdoc-function-code language-cpp">ByteArrayBuilder()</code></pre></h3><p>Declared at: <a class="is-family-code" href="https://github.com/llvm/llvm-project/blob/release/10.x/llvm/include/llvm/Transforms/IPO/LowerTypeTests.h#L183">llvm/include/llvm/Transforms/IPO/LowerTypeTests.h:183</a></p><h3 id="F1140C93418424D0"><pre class="p-0 hdoc-pre-parent"><a class="hdoc-permalink-icon" href="#F1140C93418424D0">¶</a><code class="hdoc-function-code language-cpp">void allocate(const <a href="https://en.cppreference.com/w/cpp/container/set">std::set</a>&lt;uint64_t&gt;&amp; Bits,
              uint64_t BitSize,
              uint64_t&amp; AllocByteOffset,
              uint8_t&amp; AllocMask)</code></pre></h3><h4>Description</h4><p>Allocate BitSize bits in the byte array where Bits contains the bits to set. AllocByteOffset is set to the offset within the byte array and AllocMask is set to the bitmask for those bits. This uses the LPT (Longest Processing Time) multiprocessor scheduling algorithm to lay out the bits efficiently; the pass allocates bit sets in decreasing size order.</p><p>Declared at: <a class="is-family-code" href="https://github.com/llvm/llvm-project/blob/release/10.x/llvm/include/llvm/Transforms/IPO/LowerTypeTests.h#L192">llvm/include/llvm/Transforms/IPO/LowerTypeTests.h:192</a></p><h4>Parameters</h4><dl><dt class="is-family-code">const <a href="https://en.cppreference.com/w/cpp/container/set">std::set</a>&lt;uint64_t&gt;&amp;<b> Bits</b></dt><dt class="is-family-code">uint64_t<b> BitSize</b></dt><dt class="is-family-code">uint64_t&amp;<b> AllocByteOffset</b></dt><dt class="is-family-code">uint8_t&amp;<b> AllocMask</b></dt></dl></main></div></div></div></section></div><footer class="footer"><p>Documentation for LLVM 10.0.0.</p><p>Generated by <a href="https://hdoc.io/">hdoc</a> version 1.4.0-hdocInternal on 2022-12-14T09:44:14 UTC.</p><p class="has-text-grey-light">19AD43E11B2996</p></footer></body></html>